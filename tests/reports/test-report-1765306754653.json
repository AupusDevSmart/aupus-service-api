{
  "timestamp": "2025-12-09T18:59:14.652Z",
  "summary": {
    "totalTests": 27,
    "totalPassed": 27,
    "totalFailed": 0,
    "totalWarned": 0,
    "successRate": "100.00%",
    "duration": 62792
  },
  "phases": [
    {
      "phase": "FASE 1: Infraestrutura",
      "passed": 6,
      "failed": 0,
      "warned": 0,
      "total": 6,
      "duration": 3320
    },
    {
      "phase": "FASE 2: CRUD de Usuários",
      "passed": 7,
      "failed": 0,
      "warned": 0,
      "total": 7,
      "duration": 25127
    },
    {
      "phase": "FASE 3: Autenticação",
      "passed": 6,
      "failed": 0,
      "warned": 0,
      "total": 6,
      "duration": 6672
    },
    {
      "phase": "FASE 4: Roles e Permissions",
      "passed": 8,
      "failed": 0,
      "warned": 0,
      "total": 8,
      "duration": 27673
    }
  ],
  "failures": [],
  "allResults": [
    {
      "phase": "FASE 1: Infraestrutura",
      "results": [
        {
          "test": "Existência de Tabelas",
          "status": "PASS",
          "message": "Todas as 6 tabelas necessárias existem",
          "data": [
            "model_has_permissions",
            "model_has_roles",
            "permissions",
            "role_has_permissions",
            "roles",
            "usuarios"
          ]
        },
        {
          "test": "Constraint da Coluna Role",
          "status": "PASS",
          "message": "Constraint encontrado com 4 valores permitidos",
          "data": {
            "constraint": "usuarios_role_check",
            "allowedValues": [
              "admin",
              "consultor",
              "gerente",
              "vendedor"
            ]
          }
        },
        {
          "test": "Índices de Performance",
          "status": "PASS",
          "message": "2 índices encontrados",
          "data": [
            {
              "tablename": "model_has_permissions",
              "indexname": "model_has_permissions_model_id_model_type_index"
            },
            {
              "tablename": "model_has_roles",
              "indexname": "model_has_roles_model_id_model_type_index"
            }
          ]
        },
        {
          "test": "Roles Cadastradas",
          "status": "PASS",
          "message": "9 roles encontradas no sistema",
          "data": [
            {
              "id": 1,
              "name": "super_admin",
              "guard_name": "api"
            },
            {
              "id": 2,
              "name": "admin",
              "guard_name": "api"
            },
            {
              "id": 3,
              "name": "cativo",
              "guard_name": "api"
            },
            {
              "id": 4,
              "name": "corretor",
              "guard_name": "api"
            },
            {
              "id": 5,
              "name": "associado",
              "guard_name": "api"
            },
            {
              "id": 6,
              "name": "proprietario",
              "guard_name": "api"
            },
            {
              "id": 7,
              "name": "gerente",
              "guard_name": "api"
            },
            {
              "id": 8,
              "name": "vendedor",
              "guard_name": "api"
            },
            {
              "id": 9,
              "name": "consultor",
              "guard_name": "api"
            }
          ]
        },
        {
          "test": "Permissions Cadastradas",
          "status": "PASS",
          "message": "126 permissions encontradas (94 modernas)",
          "data": {
            "total": 126,
            "modern": 94,
            "sample": [
              {
                "id": 1,
                "name": "PainelGeral"
              },
              {
                "id": 2,
                "name": "PainelGeralOrganizacoes"
              },
              {
                "id": 3,
                "name": "PainelGeralCativos"
              },
              {
                "id": 4,
                "name": "PainelGeralClube"
              },
              {
                "id": 5,
                "name": "MonitoramentoOrganizacoes"
              },
              {
                "id": 6,
                "name": "Monitoramento"
              },
              {
                "id": 7,
                "name": "NET"
              },
              {
                "id": 8,
                "name": "CRM"
              },
              {
                "id": 9,
                "name": "Oportunidades"
              },
              {
                "id": 10,
                "name": "Usuarios"
              }
            ]
          }
        },
        {
          "test": "Relacionamento Roles-Permissions",
          "status": "PASS",
          "message": "6 roles têm permissions associadas",
          "data": {
            "rolesWithPermissions": 6
          }
        }
      ]
    },
    {
      "phase": "FASE 2: CRUD de Usuários",
      "results": [
        {
          "test": "Criar Usuário Simples",
          "status": "PASS",
          "message": "Usuário criado com sucesso. ID: ckvtnekyhken43prkezk4yyucv",
          "data": {
            "userId": "ckvtnekyhken43prkezk4yyucv",
            "email": "teste.simples.1765306698589@teste.com",
            "role": []
          }
        },
        {
          "test": "Criar Usuário com RoleId",
          "status": "PASS",
          "message": "Usuário criado com roleId 2",
          "data": {
            "userId": "plo15hglhkd9quqsvpmxwwpwhb",
            "roleId": 2,
            "roleName": "admin"
          }
        },
        {
          "test": "Criar Usuário com PermissionIds",
          "status": "PASS",
          "message": "Usuário criado com 3 permissions",
          "data": {
            "userId": "16ltf8wbrd6xfq5gm27yrkbevc",
            "permissionIds": [
              124,
              126,
              123
            ]
          }
        },
        {
          "test": "Listar Usuários",
          "status": "PASS",
          "message": "Listagem retornou 10 usuários",
          "data": {
            "total": 46,
            "returned": 10,
            "page": 1,
            "totalPages": 5
          }
        },
        {
          "test": "Buscar Usuário por ID",
          "status": "PASS",
          "message": "Usuário encontrado: Usuário Teste Simples",
          "data": {
            "id": "ckvtnekyhken43prkezk4yyucv",
            "nome": "Usuário Teste Simples",
            "email": "teste.simples.1765306698589@teste.com"
          }
        },
        {
          "test": "Atualizar Usuário",
          "status": "PASS",
          "message": "Usuário atualizado com sucesso",
          "data": {
            "id": "ckvtnekyhken43prkezk4yyucv",
            "nome": "Usuário Teste ATUALIZADO",
            "telefone": "11966666666"
          }
        },
        {
          "test": "Deletar Usuário",
          "status": "PASS",
          "message": "Usuário deletado com sucesso (soft delete)"
        }
      ]
    },
    {
      "phase": "FASE 3: Autenticação",
      "results": [
        {
          "test": "Login com Credenciais Válidas",
          "status": "PASS",
          "message": "Login realizado com sucesso, tokens recebidos",
          "data": {
            "hasAccessToken": true,
            "hasRefreshToken": true,
            "tokenType": "Bearer",
            "expiresIn": 3600,
            "user": "admin@email.com"
          }
        },
        {
          "test": "Login com Credenciais Inválidas",
          "status": "PASS",
          "message": "Login rejeitado corretamente (401/400)",
          "data": {
            "status": 401
          }
        },
        {
          "test": "Payload do JWT",
          "status": "PASS",
          "message": "Token contém todos os campos necessários",
          "data": {
            "sub": "k6g72ojagrl415bsak6y68qi96",
            "email": "admin@email.com",
            "nome": "Admin",
            "role": "super_admin",
            "permissions": 22,
            "exp": 1765310321,
            "iat": 1765306721
          }
        },
        {
          "test": "Refresh Token",
          "status": "PASS",
          "message": "Tokens renovados com sucesso",
          "data": {
            "hasNewAccessToken": true,
            "hasNewRefreshToken": true,
            "tokensAreDifferent": true
          }
        },
        {
          "test": "Rota Protegida com Token Válido",
          "status": "PASS",
          "message": "Acesso autorizado com token JWT",
          "data": {
            "userId": "k6g72ojagrl415bsak6y68qi96",
            "email": "admin@email.com",
            "nome": "Admin"
          }
        },
        {
          "test": "Rota Protegida sem Token",
          "status": "PASS",
          "message": "Acesso bloqueado corretamente (401 Unauthorized)",
          "data": {
            "status": 401
          }
        }
      ]
    },
    {
      "phase": "FASE 4: Roles e Permissions",
      "results": [
        {
          "test": "Atribuir Role",
          "status": "PASS",
          "message": "Role \"admin\" atribuída com sucesso",
          "data": {
            "roleId": 2,
            "roleName": "admin"
          }
        },
        {
          "test": "Atribuir Permissão Direta",
          "status": "PASS",
          "message": "Permission \"admin.impersonate\" atribuída com sucesso",
          "data": {
            "permissionId": 124,
            "permissionName": "admin.impersonate"
          }
        },
        {
          "test": "Remover Permissão Direta",
          "status": "PASS",
          "message": "Permission removida com sucesso",
          "data": {
            "permissionId": 124
          }
        },
        {
          "test": "Sincronizar Permissões",
          "status": "PASS",
          "message": "3 permissions sincronizadas",
          "data": {
            "count": 3,
            "permissionIds": [
              124,
              126,
              123
            ]
          }
        },
        {
          "test": "Buscar Permissões do Usuário",
          "status": "PASS",
          "message": "Permissões obtidas com sucesso",
          "data": {
            "hasRole": true,
            "roleName": "admin",
            "totalPermissions": 17,
            "permissionNames": [
              "admin.impersonate",
              "admin.manage_permissions",
              "admin.super",
              "Arquivos",
              "Cadastros"
            ]
          }
        },
        {
          "test": "Verificar Permissão Específica",
          "status": "PASS",
          "message": "Verificação funcionando corretamente",
          "data": {
            "permission": "admin.impersonate",
            "hasPermission": true
          }
        },
        {
          "test": "Verificar Múltiplas Permissões",
          "status": "PASS",
          "message": "Verificação de múltiplas permissions funcionando",
          "data": {
            "permissions": [
              "admin.impersonate",
              "admin.manage_permissions"
            ],
            "hasPermissions": true,
            "details": {
              "admin.impersonate": true,
              "admin.manage_permissions": true
            }
          }
        },
        {
          "test": "Categorização de Permissões",
          "status": "PASS",
          "message": "Permissions categorizadas em 2 categorias",
          "data": {
            "categories": [
              "admin",
              "Outros"
            ],
            "sample": [
              "admin",
              "Outros"
            ]
          }
        }
      ]
    }
  ]
}