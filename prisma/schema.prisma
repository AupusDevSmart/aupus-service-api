generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model cache_locks {
  key        String @id @db.VarChar(255)
  owner      String @db.VarChar(255)
  expiration Int
}

model concessionaria_usuario {
  concessionaria_id String          @db.Char(26)
  usuario_id        String          @db.Char(26)
  created_at        DateTime?       @db.Timestamp(0)
  updated_at        DateTime?       @db.Timestamp(0)
  concessionarias   concessionarias @relation(fields: [concessionaria_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "concessionaria_usuario_concessionaria_id_foreign")
  usuarios          usuarios        @relation(fields: [usuario_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "concessionaria_usuario_usuario_id_foreign")

  @@id([concessionaria_id, usuario_id])
}

model concessionarias {
  id                      String                   @id @db.Char(26)
  nome                    String                   @db.VarChar(255)
  estado                  String                   @db.VarChar(2)
  cnpj                    String                   @db.VarChar(14)
  ano                     Int
  reh                     String?                  @db.VarChar(255)
  mes_revisao             Int?
  logo_url                String?
  a3a_conv_az_tusd_dem_p  Decimal?                 @db.Decimal(10, 8)
  a3a_conv_az_tusd_con_p  Decimal?                 @db.Decimal(10, 8)
  a3a_conv_az_tusd_te_p   Decimal?                 @db.Decimal(10, 8)
  a3a_conv_az_tusd_dem_fp Decimal?                 @db.Decimal(10, 8)
  a3a_conv_az_tusd_con_fp Decimal?                 @db.Decimal(10, 8)
  a3a_conv_az_tusd_te_fp  Decimal?                 @db.Decimal(10, 8)
  a3a_scee_az_tusd_dem_p  Decimal?                 @db.Decimal(10, 8)
  a3a_scee_az_tusd_con_p  Decimal?                 @db.Decimal(10, 8)
  a3a_scee_az_tusd_te_p   Decimal?                 @db.Decimal(10, 8)
  a3a_scee_az_tusd_dem_fp Decimal?                 @db.Decimal(10, 8)
  a3a_scee_az_tusd_con_fp Decimal?                 @db.Decimal(10, 8)
  a3a_scee_az_tusd_te_fp  Decimal?                 @db.Decimal(10, 8)
  a3a_conv_vd_tusd_dem    Decimal?                 @db.Decimal(10, 8)
  a3a_conv_vd_tusd_con_p  Decimal?                 @db.Decimal(10, 8)
  a3a_conv_vd_tusd_te_p   Decimal?                 @db.Decimal(10, 8)
  a3a_conv_vd_tusd_con_fp Decimal?                 @db.Decimal(10, 8)
  a3a_conv_vd_tusd_te_fp  Decimal?                 @db.Decimal(10, 8)
  a3a_scee_vd_tusd_dem    Decimal?                 @db.Decimal(10, 8)
  a3a_scee_vd_tusd_con_p  Decimal?                 @db.Decimal(10, 8)
  a3a_scee_vd_tusd_te_p   Decimal?                 @db.Decimal(10, 8)
  a3a_scee_vd_tusd_con_fp Decimal?                 @db.Decimal(10, 8)
  a3a_scee_vd_tusd_te_fp  Decimal?                 @db.Decimal(10, 8)
  a3a_az_tusd_dem_g       Decimal?                 @db.Decimal(10, 8)
  a4_conv_az_tusd_dem_p   Decimal?                 @db.Decimal(10, 8)
  a4_conv_az_tusd_con_p   Decimal?                 @db.Decimal(10, 8)
  a4_conv_az_tusd_te_p    Decimal?                 @db.Decimal(10, 8)
  a4_conv_az_tusd_dem_fp  Decimal?                 @db.Decimal(10, 8)
  a4_conv_az_tusd_con_fp  Decimal?                 @db.Decimal(10, 8)
  a4_conv_az_tusd_te_fp   Decimal?                 @db.Decimal(10, 8)
  a4_scee_az_tusd_dem_p   Decimal?                 @db.Decimal(10, 8)
  a4_scee_az_tusd_con_p   Decimal?                 @db.Decimal(10, 8)
  a4_scee_az_tusd_te_p    Decimal?                 @db.Decimal(10, 8)
  a4_scee_az_tusd_dem_fp  Decimal?                 @db.Decimal(10, 8)
  a4_scee_az_tusd_con_fp  Decimal?                 @db.Decimal(10, 8)
  a4_scee_az_tusd_te_fp   Decimal?                 @db.Decimal(10, 8)
  a4_conv_vd_tusd_dem     Decimal?                 @db.Decimal(10, 8)
  a4_conv_vd_tusd_con_p   Decimal?                 @db.Decimal(10, 8)
  a4_conv_vd_tusd_te_p    Decimal?                 @db.Decimal(10, 8)
  a4_conv_vd_tusd_con_fp  Decimal?                 @db.Decimal(10, 8)
  a4_conv_vd_tusd_te_fp   Decimal?                 @db.Decimal(10, 8)
  a4_scee_vd_tusd_dem     Decimal?                 @db.Decimal(10, 8)
  a4_scee_vd_tusd_con_p   Decimal?                 @db.Decimal(10, 8)
  a4_scee_vd_tusd_te_p    Decimal?                 @db.Decimal(10, 8)
  a4_scee_vd_tusd_con_fp  Decimal?                 @db.Decimal(10, 8)
  a4_scee_vd_tusd_te_fp   Decimal?                 @db.Decimal(10, 8)
  a4_az_tusd_dem_g        Decimal?                 @db.Decimal(10, 8)
  b3_conv_tusd            Decimal?                 @db.Decimal(10, 8)
  b3_conv_te              Decimal?                 @db.Decimal(10, 8)
  b3_scee_tusd            Decimal?                 @db.Decimal(10, 8)
  b3_scee_te              Decimal?                 @db.Decimal(10, 8)
  created_at              DateTime?                @db.Timestamp(0)
  updated_at              DateTime?                @db.Timestamp(0)
  deleted_at              DateTime?                @db.Timestamp(0)
  concessionaria_usuario  concessionaria_usuario[]
  documentos              documentos[]
  faturas                 faturas[]
  historicos_faturamento  historicos_faturamento[]
  unidades_consumidoras   unidades_consumidoras[]
  usuarios                usuarios[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model configuracoes {
  id         String    @id @db.VarChar(36)
  chave      String    @unique(map: "configuracoes_chave_unique") @db.VarChar(50)
  valor      String
  tipo       String    @default("string") @db.VarChar(255)
  descricao  String?
  grupo      String    @default("geral") @db.VarChar(50)
  updated_by String?   @db.VarChar(36)
  created_at DateTime? @db.Timestamp(0)
  updated_at DateTime? @db.Timestamp(0)
  usuarios   usuarios? @relation(fields: [updated_by], references: [id], onUpdate: NoAction, map: "fk_config_updated_by")

  @@index([chave], map: "idx_config_chave")
  @@index([grupo], map: "idx_config_grupo")
  @@index([updated_by], map: "idx_config_updated_by")
}

model consorcios {
  id             String       @id @db.Char(26)
  organizacao_id String       @db.Char(26)
  nome           String       @db.VarChar(255)
  cnpj           String       @unique(map: "consorcios_cnpj_unique") @db.VarChar(255)
  ato            String       @db.VarChar(255)
  deleted_at     DateTime?    @db.Timestamp(0)
  created_at     DateTime?    @db.Timestamp(0)
  updated_at     DateTime?    @db.Timestamp(0)
  organizacoes   organizacoes @relation(fields: [organizacao_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "consorcios_organizacao_id_foreign")
  rateios        rateios[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model controle_clube {
  id                                                                String                 @id @db.VarChar(36)
  proposta_id                                                       String                 @db.VarChar(36)
  uc_id                                                             String                 @db.VarChar(36)
  ug_id                                                             String?                @db.VarChar(36)
  observacoes                                                       String?
  data_entrada_controle                                             DateTime               @default(now()) @db.Timestamp(0)
  created_at                                                        DateTime?              @db.Timestamp(0)
  updated_at                                                        DateTime?              @db.Timestamp(0)
  deleted_at                                                        DateTime?              @db.Timestamp(0)
  calibragem                                                        Decimal                @default(0) @db.Decimal(5, 2)
  valor_calibrado                                                   Decimal?               @db.Decimal(10, 2)
  status_troca                                                      String                 @default("Aguardando") @db.VarChar(255)
  data_titularidade                                                 DateTime               @default(dbgenerated("'2025-08-20'::date")) @db.Date
  propostas                                                         propostas              @relation(fields: [proposta_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_controle_proposta")
  unidades_consumidoras_controle_clube_uc_idTounidades_consumidoras unidades_consumidoras  @relation("controle_clube_uc_idTounidades_consumidoras", fields: [uc_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_controle_uc")
  unidades_consumidoras_controle_clube_ug_idTounidades_consumidoras unidades_consumidoras? @relation("controle_clube_ug_idTounidades_consumidoras", fields: [ug_id], references: [id], onUpdate: NoAction, map: "fk_controle_ug")

  @@unique([proposta_id, uc_id], map: "unique_proposta_uc")
  @@index([status_troca], map: "controle_clube_status_troca_index")
  @@index([data_entrada_controle], map: "idx_controle_data_entrada")
  @@index([proposta_id], map: "idx_controle_proposta")
  @@index([uc_id], map: "idx_controle_uc")
  @@index([ug_id], map: "idx_controle_ug")
}

model documentos {
  id                String           @id @db.Char(26)
  nome              String           @db.VarChar(255)
  nome_original     String           @db.VarChar(255)
  tipo              String           @db.VarChar(255)
  mime_type         String           @db.VarChar(255)
  tamanho           BigInt
  descricao         String?
  caminho_s3        String           @db.VarChar(255)
  usuario_id        String           @db.Char(26)
  organizacao_id    String?          @db.Char(26)
  concessionaria_id String?          @db.Char(26)
  created_at        DateTime?        @db.Timestamp(0)
  updated_at        DateTime?        @db.Timestamp(0)
  deleted_at        DateTime?        @db.Timestamp(0)
  concessionarias   concessionarias? @relation(fields: [concessionaria_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "documentos_concessionaria_id_foreign")
  organizacoes      organizacoes?    @relation(fields: [organizacao_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "documentos_organizacao_id_foreign")
  usuarios          usuarios         @relation(fields: [usuario_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "documentos_usuario_id_foreign")

  @@index([organizacao_id, created_at], map: "documentos_organizacao_id_created_at_index")
  @@index([usuario_id, created_at], map: "documentos_usuario_id_created_at_index")
}

model enderecos {
  id                    String                  @id @db.Char(26)
  endereco_curto        String?                 @db.VarChar(255)
  logradouro            String                  @db.VarChar(255)
  numero                String                  @db.VarChar(255)
  complemento           String?                 @db.VarChar(255)
  bairro                String                  @db.VarChar(255)
  cidade                String                  @db.VarChar(255)
  estado                String                  @db.VarChar(2)
  pais                  String                  @default("Brasil") @db.VarChar(255)
  cep                   String?                 @db.VarChar(9)
  referencia            String?                 @db.VarChar(255)
  latitude              Decimal?                @db.Decimal(10, 8)
  longitude             Decimal?                @db.Decimal(11, 8)
  enderecavel_id        String                  @db.Char(26)
  enderecavel_tipo      String                  @db.VarChar(255)
  deleted_at            DateTime?               @db.Timestamp(0)
  created_at            DateTime?               @db.Timestamp(0)
  updated_at            DateTime?               @db.Timestamp(0)
  unidades_consumidoras unidades_consumidoras[]
}

model failed_jobs {
  id         BigInt   @id @default(autoincrement())
  uuid       String   @unique(map: "failed_jobs_uuid_unique") @db.VarChar(255)
  connection String
  queue      String
  payload    String
  exception  String
  failed_at  DateTime @default(now()) @db.Timestamp(0)
}

model faturas {
  id                        String                @id @db.Char(26)
  concessionaria_id         String                @db.Char(26)
  unidade_consumidora_id    String                @db.Char(26)
  mes_ref                   String                @db.VarChar(7)
  compensacao_habilitada    Boolean               @default(false)
  conta_link_concessionaria String?
  valor_concessionaria      Decimal?              @db.Decimal(12, 2)
  vencimento_concessionaria DateTime?             @db.Date
  status_concessionaria     String?               @db.VarChar(255)
  conta_link_consorcio      String?
  valor_consorcio           Decimal?              @db.Decimal(12, 2)
  vencimento_consorcio      DateTime?             @db.Date
  status_consorcio          String?               @db.VarChar(255)
  created_at                DateTime?             @db.Timestamp(0)
  updated_at                DateTime?             @db.Timestamp(0)
  concessionarias           concessionarias       @relation(fields: [concessionaria_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "faturas_concessionaria_id_foreign")
  unidades_consumidoras     unidades_consumidoras @relation(fields: [unidade_consumidora_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "faturas_unidade_consumidora_id_foreign")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model feedbacks {
  id         String    @id @db.Char(26)
  status     String    @db.VarChar(255)
  usuario_id String    @db.Char(26)
  tipo       String    @db.VarChar(255)
  descricao  String
  created_at DateTime? @db.Timestamp(0)
  updated_at DateTime? @db.Timestamp(0)
  usuarios   usuarios  @relation(fields: [usuario_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "feedbacks_usuario_id_foreign")
}

model historicos_faturamento {
  id                                  String                @id @db.Char(26)
  unidade_consumidora_id              String                @db.Char(26)
  concessionaria_id                   String?               @db.Char(26)
  id_regra_faturamento                String?               @db.VarChar(255)
  uc                                  String?               @db.VarChar(255)
  cliente                             String?               @db.VarChar(255)
  grupo                               String?               @db.VarChar(1)
  status                              String?               @db.VarChar(255)
  data_leitura                        DateTime?             @db.Date
  mes_referencia                      String?               @db.VarChar(7)
  bandeira                            String?               @db.VarChar(255)
  valor_bandeira                      Decimal?              @db.Decimal(12, 2)
  conta_link                          String?
  adc_bandeira_amarela                Decimal?              @db.Decimal(12, 2)
  rs_adc_bandeira_amarela             Decimal?              @db.Decimal(12, 4)
  valor_adc_bandeira_amarela          Decimal?              @db.Decimal(12, 2)
  adc_bandeira_amarela_hr             Decimal?              @db.Decimal(12, 2)
  rs_adc_bandeira_amarela_hr          Decimal?              @db.Decimal(12, 4)
  valor_adc_bandeira_amarela_hr       Decimal?              @db.Decimal(12, 2)
  adc_bandeira_amarela_fp             Decimal?              @db.Decimal(12, 2)
  rs_adc_bandeira_amarela_fp          Decimal?              @db.Decimal(12, 4)
  valor_adc_bandeira_amarela_fp       Decimal?              @db.Decimal(12, 2)
  adc_bandeira_amarela_p              Decimal?              @db.Decimal(12, 2)
  rs_adc_bandeira_amarela_p           Decimal?              @db.Decimal(12, 4)
  valor_adc_bandeira_amarela_p        Decimal?              @db.Decimal(12, 2)
  adc_bandeira_amarela_hi             Decimal?              @db.Decimal(12, 2)
  rs_adc_bandeira_amarela_hi          Decimal?              @db.Decimal(12, 4)
  valor_adc_bandeira_amarela_hi       Decimal?              @db.Decimal(12, 2)
  adc_bandeira_vermelha               Decimal?              @db.Decimal(12, 2)
  rs_adc_bandeira_vermelha            Decimal?              @db.Decimal(12, 4)
  valor_adc_bandeira_vermelha         Decimal?              @db.Decimal(12, 2)
  adc_bandeira_vermelha_p             Decimal?              @db.Decimal(12, 2)
  rs_adc_bandeira_vermelha_p          Decimal?              @db.Decimal(12, 4)
  valor_adc_bandeira_vermelha_p       Decimal?              @db.Decimal(12, 2)
  adc_bandeira_vermelha_fp            Decimal?              @db.Decimal(12, 2)
  rs_adc_bandeira_vermelha_fp         Decimal?              @db.Decimal(12, 4)
  valor_adc_bandeira_vermelha_fp      Decimal?              @db.Decimal(12, 2)
  adc_bandeira_vermelha_hr            Decimal?              @db.Decimal(12, 2)
  rs_adc_bandeira_vermelha_hr         Decimal?              @db.Decimal(12, 4)
  valor_adc_bandeira_vermelha_hr      Decimal?              @db.Decimal(12, 2)
  adc_bandeira_vermelha_hi            Decimal?              @db.Decimal(12, 2)
  rs_adc_bandeira_vermelha_hi         Decimal?              @db.Decimal(12, 4)
  valor_adc_bandeira_vermelha_hi      Decimal?              @db.Decimal(12, 2)
  consumo_n_comp                      Decimal?              @db.Decimal(12, 2)
  rs_consumo_n_comp                   Decimal?              @db.Decimal(12, 4)
  valor_consumo_n_comp                Decimal?              @db.Decimal(12, 2)
  consumo_n_comp_p_tusd               Decimal?              @db.Decimal(12, 2)
  rs_consumo_n_comp_p_tusd            Decimal?              @db.Decimal(12, 4)
  valor_consumo_n_comp_p_tusd         Decimal?              @db.Decimal(12, 2)
  consumo_n_comp_fp_tusd              Decimal?              @db.Decimal(12, 2)
  rs_consumo_n_comp_fp_tusd           Decimal?              @db.Decimal(12, 4)
  valor_consumo_n_comp_fp_tusd        Decimal?              @db.Decimal(12, 2)
  consumo_n_comp_hr_tusd              Decimal?              @db.Decimal(12, 2)
  rs_consumo_n_comp_hr_tusd           Decimal?              @db.Decimal(12, 4)
  valor_consumo_n_comp_hr_tusd        Decimal?              @db.Decimal(12, 2)
  consumo_n_comp_p_te                 Decimal?              @db.Decimal(12, 2)
  rs_consumo_n_comp_p_te              Decimal?              @db.Decimal(12, 4)
  valor_consumo_n_comp_p_te           Decimal?              @db.Decimal(12, 2)
  consumo_n_comp_fp_te                Decimal?              @db.Decimal(12, 2)
  rs_consumo_n_comp_fp_te             Decimal?              @db.Decimal(12, 4)
  valor_consumo_n_comp_fp_te          Decimal?              @db.Decimal(12, 2)
  consumo_n_comp_hr_te                Decimal?              @db.Decimal(12, 2)
  rs_consumo_n_comp_hr_te             Decimal?              @db.Decimal(12, 4)
  valor_consumo_n_comp_hr_te          Decimal?              @db.Decimal(12, 2)
  consumo_comp                        Decimal?              @db.Decimal(12, 2)
  rs_consumo_comp                     Decimal?              @db.Decimal(12, 4)
  valor_consumo_comp                  Decimal?              @db.Decimal(12, 2)
  consumo_comp_p_tusd                 Decimal?              @db.Decimal(12, 2)
  rs_consumo_comp_p_tusd              Decimal?              @db.Decimal(12, 4)
  valor_consumo_comp_p_tusd           Decimal?              @db.Decimal(12, 2)
  consumo_comp_fp_tusd                Decimal?              @db.Decimal(12, 2)
  rs_consumo_comp_fp_tusd             Decimal?              @db.Decimal(12, 4)
  valor_consumo_comp_fp_tusd          Decimal?              @db.Decimal(12, 2)
  consumo_comp_hr_tusd                Decimal?              @db.Decimal(12, 2)
  rs_consumo_comp_hr_tusd             Decimal?              @db.Decimal(12, 4)
  valor_consumo_comp_hr_tusd          Decimal?              @db.Decimal(12, 2)
  consumo_comp_p_te                   Decimal?              @db.Decimal(12, 2)
  rs_consumo_comp_p_te                Decimal?              @db.Decimal(12, 4)
  valor_consumo_comp_p_te             Decimal?              @db.Decimal(12, 2)
  consumo_comp_fp_te                  Decimal?              @db.Decimal(12, 2)
  rs_consumo_comp_fp_te               Decimal?              @db.Decimal(12, 4)
  valor_consumo_comp_fp_te            Decimal?              @db.Decimal(12, 2)
  consumo_comp_hr_te                  Decimal?              @db.Decimal(12, 2)
  rs_consumo_comp_hr_te               Decimal?              @db.Decimal(12, 4)
  valor_consumo_comp_hr_te            Decimal?              @db.Decimal(12, 2)
  consumo                             Decimal?              @db.Decimal(12, 2)
  rs_consumo                          Decimal?              @db.Decimal(12, 4)
  valor_consumo                       Decimal?              @db.Decimal(12, 2)
  consumo_p_tusd                      Decimal?              @db.Decimal(12, 2)
  rs_consumo_p_tusd                   Decimal?              @db.Decimal(12, 4)
  valor_consumo_p_tusd                Decimal?              @db.Decimal(12, 2)
  consumo_fp_tusd                     Decimal?              @db.Decimal(12, 2)
  rs_consumo_fp_tusd                  Decimal?              @db.Decimal(12, 4)
  valor_consumo_fp_tusd               Decimal?              @db.Decimal(12, 2)
  consumo_hr_tusd                     Decimal?              @db.Decimal(12, 2)
  rs_consumo_hr_tusd                  Decimal?              @db.Decimal(12, 4)
  valor_consumo_hr_tusd               Decimal?              @db.Decimal(12, 2)
  consumo_p_te                        Decimal?              @db.Decimal(12, 2)
  rs_consumo_p_te                     Decimal?              @db.Decimal(12, 4)
  valor_consumo_p_te                  Decimal?              @db.Decimal(12, 2)
  consumo_fp_te                       Decimal?              @db.Decimal(12, 2)
  rs_consumo_fp_te                    Decimal?              @db.Decimal(12, 4)
  valor_consumo_fp_te                 Decimal?              @db.Decimal(12, 2)
  consumo_hr_te                       Decimal?              @db.Decimal(12, 2)
  rs_consumo_hr_te                    Decimal?              @db.Decimal(12, 4)
  valor_consumo_hr_te                 Decimal?              @db.Decimal(12, 2)
  consumo_p                           Decimal?              @db.Decimal(12, 2)
  rs_consumo_p                        Decimal?              @db.Decimal(12, 4)
  valor_consumo_p                     Decimal?              @db.Decimal(12, 2)
  consumo_fp                          Decimal?              @db.Decimal(12, 2)
  rs_consumo_fp                       Decimal?              @db.Decimal(12, 4)
  valor_consumo_fp                    Decimal?              @db.Decimal(12, 2)
  consumo_hr                          Decimal?              @db.Decimal(12, 2)
  rs_consumo_hr                       Decimal?              @db.Decimal(12, 4)
  valor_consumo_hr                    Decimal?              @db.Decimal(12, 2)
  consumo_hi                          Decimal?              @db.Decimal(12, 2)
  rs_consumo_hi                       Decimal?              @db.Decimal(12, 4)
  valor_consumo_hi                    Decimal?              @db.Decimal(12, 2)
  consumo_comp_hi                     Decimal?              @db.Decimal(12, 2)
  rs_consumo_comp_hi                  Decimal?              @db.Decimal(12, 4)
  valor_consumo_comp_hi               Decimal?              @db.Decimal(12, 2)
  consumo_n_comp_hi                   Decimal?              @db.Decimal(12, 2)
  rs_consumo_n_comp_hi                Decimal?              @db.Decimal(12, 4)
  valor_consumo_n_comp_hi             Decimal?              @db.Decimal(12, 2)
  valor_credito_consumo               Decimal?              @db.Decimal(12, 2)
  energia_injetada                    Decimal?              @db.Decimal(12, 2)
  rs_energia_injetada                 Decimal?              @db.Decimal(12, 4)
  valor_energia_injetada              Decimal?              @db.Decimal(12, 2)
  rs_energia_injetada_tusd_p          Decimal?              @db.Decimal(12, 4)
  rs_energia_injetada_te_p            Decimal?              @db.Decimal(12, 4)
  valor_energia_injetada_tusd_p       Decimal?              @db.Decimal(12, 2)
  valor_energia_injetada_te_p         Decimal?              @db.Decimal(12, 2)
  rs_energia_injetada_tusd_fp         Decimal?              @db.Decimal(12, 4)
  rs_energia_injetada_te_fp           Decimal?              @db.Decimal(12, 4)
  valor_energia_injetada_tusd_fp      Decimal?              @db.Decimal(12, 2)
  valor_energia_injetada_te_fp        Decimal?              @db.Decimal(12, 2)
  rs_energia_injetada_tusd_hr         Decimal?              @db.Decimal(12, 4)
  rs_energia_injetada_te_hr           Decimal?              @db.Decimal(12, 4)
  valor_energia_injetada_tusd_hr      Decimal?              @db.Decimal(12, 2)
  valor_energia_injetada_te_hr        Decimal?              @db.Decimal(12, 2)
  energia_injetada_hi                 Decimal?              @db.Decimal(12, 2)
  rs_energia_injetada_hi              Decimal?              @db.Decimal(12, 4)
  valor_energia_injetada_hi           Decimal?              @db.Decimal(12, 2)
  demanda_faturada                    Decimal?              @db.Decimal(12, 2)
  rs_demanda_faturada                 Decimal?              @db.Decimal(12, 4)
  valor_demanda                       Decimal?              @db.Decimal(12, 2)
  demanda_faturada_p                  Decimal?              @db.Decimal(12, 2)
  rs_demanda_faturada_p               Decimal?              @db.Decimal(12, 4)
  demanda_faturada_fp                 Decimal?              @db.Decimal(12, 2)
  rs_demanda_faturada_fp              Decimal?              @db.Decimal(12, 4)
  demanda_faturada_hr                 Decimal?              @db.Decimal(12, 2)
  rs_demanda_faturada_hr              Decimal?              @db.Decimal(12, 4)
  demanda_ultrapassagem               Decimal?              @db.Decimal(12, 2)
  rs_demanda_ultrapassagem            Decimal?              @db.Decimal(12, 4)
  valor_demanda_ultrapassagem         Decimal?              @db.Decimal(12, 2)
  demanda_ultrapassagem_p             Decimal?              @db.Decimal(12, 2)
  rs_demanda_ultrapassagem_p          Decimal?              @db.Decimal(12, 4)
  demanda_ultrapassagem_fp            Decimal?              @db.Decimal(12, 2)
  rs_demanda_ultrapassagem_fp         Decimal?              @db.Decimal(12, 4)
  demanda_ultrapassagem_hr            Decimal?              @db.Decimal(12, 2)
  rs_demanda_ultrapassagem_hr         Decimal?              @db.Decimal(12, 4)
  demanda_ultrapassagem_geracao       Decimal?              @db.Decimal(12, 2)
  rs_demanda_ultrapassagem_geracao    Decimal?              @db.Decimal(12, 4)
  valor_demanda_ultra_geracao         Decimal?              @db.Decimal(12, 2)
  demanda_geracao                     Decimal?              @db.Decimal(12, 2)
  rs_demanda_geracao                  Decimal?              @db.Decimal(12, 4)
  valor_demanda_geracao               Decimal?              @db.Decimal(12, 2)
  demanda_isento_faturada             Decimal?              @db.Decimal(12, 2)
  rs_demanda_isento_faturada          Decimal?              @db.Decimal(12, 4)
  valor_demanda_isento                Decimal?              @db.Decimal(12, 2)
  demanda_contratada                  Decimal?              @db.Decimal(12, 2)
  ufer_p                              Decimal?              @db.Decimal(12, 2)
  rs_ufer_p                           Decimal?              @db.Decimal(12, 4)
  valor_ufer_p                        Decimal?              @db.Decimal(12, 2)
  ufer_fp                             Decimal?              @db.Decimal(12, 2)
  rs_ufer_fp                          Decimal?              @db.Decimal(12, 4)
  valor_ufer_fp                       Decimal?              @db.Decimal(12, 2)
  ufer_hr                             Decimal?              @db.Decimal(12, 2)
  rs_ufer_hr                          Decimal?              @db.Decimal(12, 4)
  valor_ufer_hr                       Decimal?              @db.Decimal(12, 2)
  ufer                                Decimal?              @db.Decimal(12, 2)
  rs_ufer                             Decimal?              @db.Decimal(12, 4)
  valor_ufer                          Decimal?              @db.Decimal(12, 2)
  valor_parc_injet                    Decimal?              @db.Decimal(12, 2)
  valor_subsidio_parc_injet_liquido   Decimal?              @db.Decimal(12, 2)
  valor_energia_comp_nao_insenta      Decimal?              @db.Decimal(12, 2)
  valor_ir                            Decimal?              @db.Decimal(12, 2)
  dmcr                                Decimal?              @db.Decimal(12, 2)
  rs_dmcr                             Decimal?              @db.Decimal(12, 4)
  valor_dmcr                          Decimal?              @db.Decimal(12, 2)
  valor_iluminacao                    Decimal?              @db.Decimal(12, 2)
  valor_juros                         Decimal?              @db.Decimal(12, 2)
  valor_multa                         Decimal?              @db.Decimal(12, 2)
  valor_dic                           Decimal?              @db.Decimal(12, 2)
  valor_fic                           Decimal?              @db.Decimal(12, 2)
  valor_dmic                          Decimal?              @db.Decimal(12, 2)
  dif_demanda                         Decimal?              @db.Decimal(12, 2)
  rs_dif_demanda                      Decimal?              @db.Decimal(12, 4)
  valor_dif_demanda                   Decimal?              @db.Decimal(12, 2)
  valor_fatura_duplicada              Decimal?              @db.Decimal(12, 2)
  valor_adicional                     Decimal?              @db.Decimal(12, 2)
  valor_correcao_ipca                 Decimal?              @db.Decimal(12, 2)
  valor_bonus_itaipu                  Decimal?              @db.Decimal(12, 2)
  valor_beneficio_bruto               Decimal?              @db.Decimal(12, 2)
  valor_beneficio_liquido             Decimal?              @db.Decimal(12, 2)
  medidor                             String?               @db.VarChar(255)
  leitura_atual_energia_ativa         Decimal?              @db.Decimal(15, 2)
  leitura_anterior_energia_ativa      Decimal?              @db.Decimal(15, 2)
  const_medidor_energia_ativa         Decimal?              @db.Decimal(8, 2)
  leitura_atual_energia_geracao       Decimal?              @db.Decimal(15, 2)
  leitura_anterior_energia_geracao    Decimal?              @db.Decimal(15, 2)
  const_medidor_energia_geracao       Decimal?              @db.Decimal(8, 2)
  leitura_atual_energia_ativa_p       Decimal?              @db.Decimal(15, 2)
  leitura_atual_energia_ativa_fp      Decimal?              @db.Decimal(15, 2)
  leitura_atual_energia_ativa_hr      Decimal?              @db.Decimal(15, 2)
  leitura_anterior_energia_ativa_p    Decimal?              @db.Decimal(15, 2)
  leitura_anterior_energia_ativa_fp   Decimal?              @db.Decimal(15, 2)
  leitura_anterior_energia_ativa_hr   Decimal?              @db.Decimal(15, 2)
  const_medidor_energia_ativa_p       Decimal?              @db.Decimal(8, 2)
  const_medidor_energia_ativa_fp      Decimal?              @db.Decimal(8, 2)
  const_medidor_energia_ativa_hr      Decimal?              @db.Decimal(8, 2)
  leitura_atual_energia_geracao_p     Decimal?              @db.Decimal(15, 2)
  leitura_atual_energia_geracao_fp    Decimal?              @db.Decimal(15, 2)
  leitura_atual_energia_geracao_hr    Decimal?              @db.Decimal(15, 2)
  leitura_anterior_energia_geracao_p  Decimal?              @db.Decimal(15, 2)
  leitura_anterior_energia_geracao_fp Decimal?              @db.Decimal(15, 2)
  leitura_anterior_energia_geracao_hr Decimal?              @db.Decimal(15, 2)
  const_medidor_energia_geracao_p     Decimal?              @db.Decimal(8, 2)
  const_medidor_energia_geracao_fp    Decimal?              @db.Decimal(8, 2)
  const_medidor_energia_geracao_hr    Decimal?              @db.Decimal(8, 2)
  leitura_atual_demanda_p             Decimal?              @db.Decimal(15, 2)
  leitura_atual_demanda_fp            Decimal?              @db.Decimal(15, 2)
  leitura_atual_demanda_hr            Decimal?              @db.Decimal(15, 2)
  leitura_anterior_demanda_p          Decimal?              @db.Decimal(15, 2)
  leitura_anterior_demanda_fp         Decimal?              @db.Decimal(15, 2)
  leitura_anterior_demanda_hr         Decimal?              @db.Decimal(15, 2)
  const_medidor_demanda_p             Decimal?              @db.Decimal(8, 2)
  const_medidor_demanda_fp            Decimal?              @db.Decimal(8, 2)
  const_medidor_demanda_hr            Decimal?              @db.Decimal(8, 2)
  leitura_atual_demanda_geracao_p     Decimal?              @db.Decimal(15, 2)
  leitura_atual_demanda_geracao_fp    Decimal?              @db.Decimal(15, 2)
  leitura_atual_demanda_geracao_hr    Decimal?              @db.Decimal(15, 2)
  leitura_anterior_demanda_geracao_p  Decimal?              @db.Decimal(15, 2)
  leitura_anterior_demanda_geracao_fp Decimal?              @db.Decimal(15, 2)
  leitura_anterior_demanda_geracao_hr Decimal?              @db.Decimal(15, 2)
  const_medidor_demanda_geracao_p     Decimal?              @db.Decimal(8, 2)
  const_medidor_demanda_geracao_fp    Decimal?              @db.Decimal(8, 2)
  const_medidor_demanda_geracao_hr    Decimal?              @db.Decimal(8, 2)
  leitura_atual_ufer_p                Decimal?              @db.Decimal(15, 2)
  leitura_atual_ufer_fp               Decimal?              @db.Decimal(15, 2)
  leitura_atual_ufer_hr               Decimal?              @db.Decimal(15, 2)
  leitura_anterior_ufer_p             Decimal?              @db.Decimal(15, 2)
  leitura_anterior_ufer_fp            Decimal?              @db.Decimal(15, 2)
  leitura_anterior_ufer_hr            Decimal?              @db.Decimal(15, 2)
  const_medidor_ufer_p                Decimal?              @db.Decimal(8, 2)
  const_medidor_ufer_fp               Decimal?              @db.Decimal(8, 2)
  const_medidor_ufer_hr               Decimal?              @db.Decimal(8, 2)
  leitura_atual_dmcr_p                Decimal?              @db.Decimal(15, 2)
  leitura_atual_dmcr_fp               Decimal?              @db.Decimal(15, 2)
  leitura_atual_dmcr_hr               Decimal?              @db.Decimal(15, 2)
  leitura_anterior_dmcr_p             Decimal?              @db.Decimal(15, 2)
  leitura_anterior_dmcr_fp            Decimal?              @db.Decimal(15, 2)
  leitura_anterior_dmcr_hr            Decimal?              @db.Decimal(15, 2)
  const_medidor_dmcr_p                Decimal?              @db.Decimal(8, 2)
  const_medidor_dmcr_fp               Decimal?              @db.Decimal(8, 2)
  const_medidor_dmcr_hr               Decimal?              @db.Decimal(8, 2)
  vencimento                          DateTime?             @db.Date
  excedente_recebido                  Decimal?              @db.Decimal(12, 2)
  excedente_recebido_p                Decimal?              @db.Decimal(12, 2)
  excedente_recebido_fp               Decimal?              @db.Decimal(12, 2)
  excedente_recebido_hr               Decimal?              @db.Decimal(12, 2)
  saldo                               Decimal?              @db.Decimal(12, 2)
  saldo_p                             Decimal?              @db.Decimal(12, 2)
  saldo_fp                            Decimal?              @db.Decimal(12, 2)
  saldo_hr                            Decimal?              @db.Decimal(12, 2)
  saldo_hi                            Decimal?              @db.Decimal(12, 2)
  saldo_30                            Decimal?              @db.Decimal(12, 2)
  saldo_60                            Decimal?              @db.Decimal(12, 2)
  saldo_30_p                          Decimal?              @db.Decimal(12, 2)
  saldo_30_fp                         Decimal?              @db.Decimal(12, 2)
  saldo_30_hr                         Decimal?              @db.Decimal(12, 2)
  saldo_60_p                          Decimal?              @db.Decimal(12, 2)
  saldo_60_fp                         Decimal?              @db.Decimal(12, 2)
  saldo_60_hr                         Decimal?              @db.Decimal(12, 2)
  saldo_teorico                       Decimal?              @db.Decimal(12, 2)
  rateio_fatura                       Decimal?              @db.Decimal(12, 2)
  valor_fatura                        Decimal?              @db.Decimal(12, 2)
  aliquota_icms                       Decimal?              @db.Decimal(5, 2)
  aliquota_pis                        Decimal?              @db.Decimal(5, 4)
  aliquota_cofins                     Decimal?              @db.Decimal(5, 4)
  valor_icms                          Decimal?              @db.Decimal(12, 2)
  valor_pis                           Decimal?              @db.Decimal(12, 2)
  valor_cofins                        Decimal?              @db.Decimal(12, 2)
  ug                                  String?               @db.VarChar(255)
  geracao_ciclo                       Decimal?              @db.Decimal(12, 2)
  geracao_ciclo_p                     Decimal?              @db.Decimal(12, 2)
  geracao_ciclo_fp                    Decimal?              @db.Decimal(12, 2)
  geracao_ciclo_hr                    Decimal?              @db.Decimal(12, 2)
  ugs_geradoras                       String?               @db.VarChar(255)
  credito_recebido                    Decimal?              @db.Decimal(12, 2)
  credito_recebido_p                  Decimal?              @db.Decimal(12, 2)
  credito_recebido_fp                 Decimal?              @db.Decimal(12, 2)
  credito_recebido_hr                 Decimal?              @db.Decimal(12, 2)
  credito_recebido_total              Decimal?              @db.Decimal(12, 2)
  tarifa_comp                         Decimal?              @db.Decimal(12, 4)
  rs_s_desconto                       Decimal?              @db.Decimal(12, 4)
  rs_economia                         Decimal?              @db.Decimal(12, 4)
  rs_aupus                            Decimal?              @db.Decimal(12, 4)
  rs_boleto                           Decimal?              @db.Decimal(12, 4)
  created_at                          DateTime?             @db.Timestamp(0)
  updated_at                          DateTime?             @db.Timestamp(0)
  deleted_at                          DateTime?             @db.Timestamp(0)
  concessionarias                     concessionarias?      @relation(fields: [concessionaria_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "historicos_faturamento_concessionaria_id_foreign")
  unidades_consumidoras               unidades_consumidoras @relation(fields: [unidade_consumidora_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "historicos_faturamento_unidade_consumidora_id_foreign")
}

model migrations {
  id        Int    @id @default(autoincrement())
  migration String @db.VarChar(255)
  batch     Int
}

model model_has_permissions {
  permission_id BigInt
  model_type    String      @db.VarChar(255)
  model_id      String      @db.Char(26)
  permissions   permissions @relation(fields: [permission_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "model_has_permissions_permission_id_foreign")

  @@id([permission_id, model_id, model_type])
  @@index([model_id, model_type], map: "model_has_permissions_model_id_model_type_index")
}

model model_has_roles {
  role_id    BigInt
  model_type String @db.VarChar(255)
  model_id   String @db.Char(26)
  roles      roles  @relation(fields: [role_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "model_has_roles_role_id_foreign")

  @@id([role_id, model_id, model_type])
  @@index([model_id, model_type], map: "model_has_roles_model_id_model_type_index")
}

model notificacoes {
  id         String    @id @db.Char(26)
  usuario_id String    @db.Char(26)
  titulo     String    @db.VarChar(255)
  descricao  String?
  lida       Boolean   @default(false)
  tipo       String    @default("info") @db.VarChar(255)
  link       String?   @db.VarChar(255)
  created_at DateTime? @db.Timestamp(0)
  updated_at DateTime? @db.Timestamp(0)
  usuarios   usuarios  @relation(fields: [usuario_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "notificacoes_usuario_id_foreign")
}

model oportunidades {
  id                                                    String       @id @db.Char(26)
  tipo                                                  String       @db.VarChar(255)
  usuario_id                                            String       @db.Char(26)
  admin_responsavel_id                                  String?      @db.Char(26)
  concessionaria_id                                     String       @db.Char(26)
  organizacao_id                                        String       @db.Char(26)
  observacao                                            String       @db.VarChar(255)
  deleted_at                                            DateTime?    @db.Timestamp(0)
  created_at                                            DateTime?    @db.Timestamp(0)
  updated_at                                            DateTime?    @db.Timestamp(0)
  usuarios_oportunidades_admin_responsavel_idTousuarios usuarios?    @relation("oportunidades_admin_responsavel_idTousuarios", fields: [admin_responsavel_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "oportunidades_admin_responsavel_id_foreign")
  organizacoes                                          organizacoes @relation(fields: [organizacao_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "oportunidades_organizacao_id_foreign")
  usuarios_oportunidades_usuario_idTousuarios           usuarios     @relation("oportunidades_usuario_idTousuarios", fields: [usuario_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "oportunidades_usuario_id_foreign")
}

model organizacao_usuario {
  organizacao_id String       @db.Char(26)
  usuario_id     String       @db.Char(26)
  created_at     DateTime?    @db.Timestamp(0)
  updated_at     DateTime?    @db.Timestamp(0)
  organizacoes   organizacoes @relation(fields: [organizacao_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "organizacao_usuario_organizacao_id_foreign")
  usuarios       usuarios     @relation(fields: [usuario_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "organizacao_usuario_usuario_id_foreign")

  @@id([organizacao_id, usuario_id])
}

model organizacoes {
  id                                                   String                @id @db.Char(26)
  nome                                                 String                @db.VarChar(255)
  email                                                String                @unique(map: "organizacoes_email_unique") @db.VarChar(255)
  status                                               String                @db.VarChar(255)
  documento                                            String?               @db.VarChar(255)
  preferencias                                         Json?                 @db.Json
  created_at                                           DateTime?             @db.Timestamp(0)
  updated_at                                           DateTime?             @db.Timestamp(0)
  deleted_at                                           DateTime?             @db.Timestamp(0)
  deleted_by                                           String?               @db.Char(26)
  consorcios                                           consorcios[]
  documentos                                           documentos[]
  oportunidades                                        oportunidades[]
  organizacao_usuario                                  organizacao_usuario[]
  usuarios_organizacoes_deleted_byTousuarios           usuarios?             @relation("organizacoes_deleted_byTousuarios", fields: [deleted_by], references: [id], onUpdate: NoAction, map: "organizacoes_deleted_by_foreign")
  rateios                                              rateios[]
  usuarios_usuarios_organizacao_atual_idToorganizacoes usuarios[]            @relation("usuarios_organizacao_atual_idToorganizacoes")
}

model password_reset_tokens {
  email      String    @id @db.VarChar(255)
  token      String    @db.VarChar(255)
  created_at DateTime? @db.Timestamp(0)
}

model permissions {
  id                    BigInt                  @id @default(autoincrement())
  name                  String                  @db.VarChar(255)
  guard_name            String                  @db.VarChar(255)
  created_at            DateTime?               @db.Timestamp(0)
  updated_at            DateTime?               @db.Timestamp(0)
  model_has_permissions model_has_permissions[]
  role_has_permissions  role_has_permissions[]

  @@unique([name, guard_name], map: "permissions_name_guard_name_unique")
}

model personal_access_tokens {
  id             BigInt    @id @default(autoincrement())
  name           String    @db.VarChar(255)
  token          String    @unique(map: "personal_access_tokens_token_unique") @db.VarChar(64)
  abilities      String?
  last_used_at   DateTime? @db.Timestamp(0)
  expires_at     DateTime? @db.Timestamp(0)
  tokenable_id   String    @db.Char(26)
  tokenable_type String    @db.VarChar(255)
  created_at     DateTime? @db.Timestamp(0)
  updated_at     DateTime? @db.Timestamp(0)
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model propostas {
  id                                        String                  @id @db.VarChar(36)
  numero_proposta                           String                  @unique(map: "propostas_numero_proposta_unique") @db.VarChar(50)
  data_proposta                             DateTime                @db.Date
  nome_cliente                              String                  @db.VarChar(200)
  usuario_id                                String                  @db.VarChar(36)
  recorrencia                               String                  @default("3%") @db.VarChar(10)
  desconto_tarifa                           String                  @default("20%") @db.VarChar(10)
  desconto_bandeira                         String                  @default("20%") @db.VarChar(10)
  observacoes                               String?
  beneficios                                Json?                   @db.Json
  created_at                                DateTime?               @db.Timestamp(0)
  updated_at                                DateTime?               @db.Timestamp(0)
  deleted_at                                DateTime?               @db.Timestamp(0)
  unidades_consumidoras                     Json?                   @db.Json
  documentacao                              Json?                   @db.Json
  inflacao                                  Decimal                 @default(2) @db.Decimal(5, 2)
  tarifa_tributos                           Decimal?                @db.Decimal(8, 4)
  consultor_id                              String?                 @db.VarChar(36)
  controle_clube                            controle_clube[]
  usuarios_propostas_consultor_idTousuarios usuarios?               @relation("propostas_consultor_idTousuarios", fields: [consultor_id], references: [id], onUpdate: NoAction, map: "fk_propostas_consultor")
  usuarios                                  usuarios                @relation(fields: [usuario_id], references: [id], onUpdate: NoAction, map: "fk_propostas_usuario")
  unidades_consumidoras_rel                 unidades_consumidoras[]

  @@index([data_proposta], map: "idx_propostas_data")
  @@index([data_proposta], map: "idx_propostas_data_proposta")
  @@index([numero_proposta], map: "idx_propostas_numero")
  @@index([usuario_id], map: "idx_propostas_usuario")
  @@index([usuario_id], map: "idx_propostas_usuario_id")
  @@index([inflacao], map: "propostas_inflacao_index")
  @@index([consultor_id], map: "idx_propostas_consultor_id")
}

model prospects {
  id                  String    @id @db.Char(26)
  usuario_id          String    @db.Char(26)
  organizacao_id      String?   @db.Char(26)
  nome                String?   @db.VarChar(255)
  cpf_cnpj            String?   @unique(map: "prospects_cpf_cnpj_unique") @db.VarChar(255)
  tipo_fornecimento   String?   @db.VarChar(255)
  grupo               String?   @db.VarChar(255)
  cidade              String?   @db.VarChar(255)
  estado              String?   @db.VarChar(255)
  status              String?   @db.VarChar(255)
  ucs                 Json?     @db.Json
  valor_fatura        Decimal?  @db.Decimal(10, 2)
  quant_consumo_medio Decimal?  @db.Decimal(10, 2)
  instagram           String?   @db.VarChar(255)
  whatsapp            String?   @db.VarChar(255)
  link_fatura         String?   @db.VarChar(255)
  deleted_at          DateTime? @db.Timestamp(0)
  created_at          DateTime? @db.Timestamp(0)
  updated_at          DateTime? @db.Timestamp(0)
  usuarios            usuarios  @relation(fields: [usuario_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "prospects_usuario_id_foreign")
}

model rateios {
  id                                                                           String                @id @db.Char(26)
  usuario_admin_id                                                             String?               @db.Char(26)
  unidade_geradora_id                                                          String                @db.Char(26)
  unidade_beneficiaria_id                                                      String                @db.Char(26)
  consorcio_id                                                                 String?               @db.Char(26)
  organizacao_id                                                               String?               @db.Char(26)
  data_rateio                                                                  DateTime              @db.Timestamp(0)
  percentual                                                                   Decimal               @db.Decimal(5, 2)
  kwh_compensado                                                               Decimal               @db.Decimal(10, 2)
  tipo                                                                         String                @db.VarChar(255)
  compensacao_habilitada                                                       Boolean
  deleted_at                                                                   DateTime?             @db.Timestamp(0)
  created_at                                                                   DateTime?             @db.Timestamp(0)
  updated_at                                                                   DateTime?             @db.Timestamp(0)
  consorcios                                                                   consorcios?           @relation(fields: [consorcio_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "rateios_consorcio_id_foreign")
  organizacoes                                                                 organizacoes?         @relation(fields: [organizacao_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "rateios_organizacao_id_foreign")
  unidades_consumidoras_rateios_unidade_beneficiaria_idTounidades_consumidoras unidades_consumidoras @relation("rateios_unidade_beneficiaria_idTounidades_consumidoras", fields: [unidade_beneficiaria_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "rateios_unidade_beneficiaria_id_foreign")
  unidades_consumidoras_rateios_unidade_geradora_idTounidades_consumidoras     unidades_consumidoras @relation("rateios_unidade_geradora_idTounidades_consumidoras", fields: [unidade_geradora_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "rateios_unidade_geradora_id_foreign")
  usuarios                                                                     usuarios?             @relation(fields: [usuario_admin_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "rateios_usuario_admin_id_foreign")
}

model role_has_permissions {
  permission_id BigInt
  role_id       BigInt
  permissions   permissions @relation(fields: [permission_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "role_has_permissions_permission_id_foreign")
  roles         roles       @relation(fields: [role_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "role_has_permissions_role_id_foreign")

  @@id([permission_id, role_id])
}

model roles {
  id                   BigInt                 @id @default(autoincrement())
  name                 String                 @db.VarChar(255)
  guard_name           String                 @db.VarChar(255)
  created_at           DateTime?              @db.Timestamp(0)
  updated_at           DateTime?              @db.Timestamp(0)
  model_has_roles      model_has_roles[]
  role_has_permissions role_has_permissions[]

  @@unique([name, guard_name], map: "roles_name_guard_name_unique")
}

model sessions {
  id            String  @id @db.VarChar(255)
  user_id       String? @db.Char(26)
  ip_address    String? @db.VarChar(45)
  user_agent    String?
  payload       String
  last_activity Int

  @@index([last_activity], map: "sessions_last_activity_index")
  @@index([user_id], map: "sessions_user_id_index")
}

model telefones {
  id               String    @id @db.Char(26)
  numero_telefone  String    @db.VarChar(255)
  telefonavel_id   String    @db.Char(26)
  telefonavel_type String    @db.VarChar(255)
  deleted_at       DateTime? @db.Timestamp(0)
  created_at       DateTime? @db.Timestamp(0)
  updated_at       DateTime? @db.Timestamp(0)
}

model telescope_entries {
  sequence                BigInt                   @id @default(autoincrement())
  uuid                    String                   @unique(map: "telescope_entries_uuid_unique") @db.Uuid
  batch_id                String                   @db.Uuid
  family_hash             String?                  @db.VarChar(255)
  should_display_on_index Boolean                  @default(true)
  type                    String                   @db.VarChar(20)
  content                 String
  created_at              DateTime?                @db.Timestamp(0)
  telescope_entries_tags  telescope_entries_tags[]

  @@index([batch_id], map: "telescope_entries_batch_id_index")
  @@index([created_at], map: "telescope_entries_created_at_index")
  @@index([family_hash], map: "telescope_entries_family_hash_index")
  @@index([type, should_display_on_index], map: "telescope_entries_type_should_display_on_index_index")
}

model telescope_entries_tags {
  entry_uuid        String            @db.Uuid
  tag               String            @db.VarChar(255)
  telescope_entries telescope_entries @relation(fields: [entry_uuid], references: [uuid], onDelete: Cascade, onUpdate: NoAction, map: "telescope_entries_tags_entry_uuid_foreign")

  @@id([entry_uuid, tag])
  @@index([tag], map: "telescope_entries_tags_tag_index")
}

model telescope_monitoring {
  tag String @id @db.VarChar(255)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model unidades_consumidoras {
  id                                                             String                   @id @db.Char(26)
  usuario_id                                                     String                   @db.Char(26)
  concessionaria_id                                              String                   @db.Char(26)
  endereco_id                                                    String?                  @db.Char(26)
  mesmo_titular                                                  Boolean                  @default(true)
  nome_titular_diferente                                         String?                  @db.VarChar(255)
  apelido                                                        String?                  @db.VarChar(255)
  numero_cliente                                                 String?                  @db.VarChar(255)
  numero_unidade                                                 BigInt
  tipo                                                           String?                  @db.VarChar(255)
  gerador                                                        Boolean                  @default(false)
  geracao_prevista                                               Decimal?                 @db.Decimal(12, 2)
  consumo_medio                                                  Decimal?                 @db.Decimal(12, 2)
  service                                                        Boolean                  @default(false)
  project                                                        Boolean                  @default(false)
  nexus_clube                                                    Boolean                  @default(false)
  nexus_cativo                                                   Boolean                  @default(false)
  proprietario                                                   Boolean                  @default(false)
  tensao_nominal                                                 Int?
  grupo                                                          String?                  @db.VarChar(1)
  ligacao                                                        String?                  @db.VarChar(255)
  irrigante                                                      Boolean                  @default(false)
  valor_beneficio_irrigante                                      Decimal?                 @db.Decimal(12, 2)
  calibragem_percentual                                          Decimal?                 @db.Decimal(5, 2)
  relacao_te                                                     Decimal?                 @db.Decimal(8, 4)
  classe                                                         String?                  @db.VarChar(255)
  subclasse                                                      String?                  @db.VarChar(255)
  tipo_conexao                                                   String?                  @db.VarChar(255)
  estrutura_tarifaria                                            String?                  @db.VarChar(255)
  contrato                                                       String?                  @db.VarChar(255)
  vencimento_contrato                                            DateTime?                @db.Date
  demanda_geracao                                                Decimal?                 @db.Decimal(12, 2)
  demanda_consumo                                                Decimal?                 @db.Decimal(12, 2)
  desconto_fatura                                                Decimal?                 @db.Decimal(5, 2)
  desconto_bandeira                                              Decimal?                 @db.Decimal(5, 2)
  created_at                                                     DateTime?                @db.Timestamp(0)
  updated_at                                                     DateTime?                @db.Timestamp(0)
  deleted_at                                                     DateTime?                @db.Timestamp(0)
  proposta_id                                                    String?                  @db.VarChar(36)
  distribuidora                                                  String?                  @db.VarChar(100)
  valor_fatura                                                   Decimal?                 @db.Decimal(10, 2)
  nome_usina                                                     String?                  @db.VarChar(200)
  potencia_cc                                                    Decimal?                 @db.Decimal(10, 2)
  fator_capacidade                                               Decimal?                 @db.Decimal(5, 2)
  capacidade_calculada                                           Decimal?                 @db.Decimal(10, 2)
  localizacao                                                    String?                  @db.VarChar(200)
  observacoes_ug                                                 String?
  ucs_atribuidas_detalhes                                        Json                     @default("[]") @db.Json
  deleted_by                                                     String?                  @db.VarChar(36)
  potencia_ca                                                    Decimal?                 @db.Decimal(10, 2)
  controle_clube_controle_clube_uc_idTounidades_consumidoras     controle_clube[]         @relation("controle_clube_uc_idTounidades_consumidoras")
  controle_clube_controle_clube_ug_idTounidades_consumidoras     controle_clube[]         @relation("controle_clube_ug_idTounidades_consumidoras")
  faturas                                                        faturas[]
  historicos_faturamento                                         historicos_faturamento[]
  rateios_rateios_unidade_beneficiaria_idTounidades_consumidoras rateios[]                @relation("rateios_unidade_beneficiaria_idTounidades_consumidoras")
  rateios_rateios_unidade_geradora_idTounidades_consumidoras     rateios[]                @relation("rateios_unidade_geradora_idTounidades_consumidoras")
  usuarios_unidades_consumidoras_deleted_byTousuarios            usuarios?                @relation("unidades_consumidoras_deleted_byTousuarios", fields: [deleted_by], references: [id], onUpdate: NoAction, map: "fk_uc_deleted_by")
  propostas                                                      propostas?               @relation(fields: [proposta_id], references: [id], onUpdate: NoAction, map: "fk_uc_proposta")
  concessionarias                                                concessionarias          @relation(fields: [concessionaria_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "unidades_consumidoras_concessionaria_id_foreign")
  enderecos                                                      enderecos?               @relation(fields: [endereco_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "unidades_consumidoras_endereco_id_foreign")
  usuarios_unidades_consumidoras_usuario_idTousuarios            usuarios                 @relation("unidades_consumidoras_usuario_idTousuarios", fields: [usuario_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "unidades_consumidoras_usuario_id_foreign")

  @@index([deleted_at, deleted_by], map: "idx_uc_deleted")
  @@index([distribuidora], map: "idx_uc_distribuidora")
  @@index([proposta_id], map: "idx_uc_proposta")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model usuarios {
  id                                                               String                   @id @db.Char(26)
  concessionaria_atual_id                                          String?                  @db.Char(26)
  organizacao_atual_id                                             String?                  @db.Char(26)
  nome                                                             String                   @db.VarChar(255)
  email                                                            String                   @unique(map: "usuarios_email_unique") @db.VarChar(255)
  telefone                                                         String?                  @db.VarChar(20)
  instagram                                                        String?                  @db.VarChar(255)
  status                                                           String                   @default("Ativo") @db.VarChar(255)
  cpf_cnpj                                                         String?                  @db.VarChar(255)
  cidade                                                           String?                  @db.VarChar(255)
  estado                                                           String?                  @db.VarChar(255)
  endereco                                                         String?                  @db.VarChar(255)
  cep                                                              String?                  @db.VarChar(255)
  deleted_by                                                       String?                  @db.Char(26)
  senha                                                            String?                  @db.VarChar(255)
  remember_token                                                   String?                  @db.VarChar(100)
  deleted_at                                                       DateTime?                @db.Timestamp(0)
  created_at                                                       DateTime?                @db.Timestamp(0)
  updated_at                                                       DateTime?                @db.Timestamp(0)
  role                                                             String                   @default("vendedor") @db.VarChar(255)
  manager_id                                                       String?                  @db.VarChar(36)
  is_active                                                        Boolean                  @default(true)
  pix                                                              String?                  @db.VarChar(255)
  anexos_anomalias_usuario                                         anexos_anomalias[]       @relation("anexos_anomalias_usuario")
  anomalias_reportadas                                             anomalias[]              @relation("anomalias_usuario")
  concessionaria_usuario                                           concessionaria_usuario[]
  configuracoes                                                    configuracoes[]
  documentos                                                       documentos[]
  equipamentos_proprietario                                        equipamentos[]           @relation("EquipamentoProprietario")
  feedbacks                                                        feedbacks[]
  notificacoes                                                     notificacoes[]
  oportunidades_oportunidades_admin_responsavel_idTousuarios       oportunidades[]          @relation("oportunidades_admin_responsavel_idTousuarios")
  oportunidades_oportunidades_usuario_idTousuarios                 oportunidades[]          @relation("oportunidades_usuario_idTousuarios")
  organizacao_usuario                                              organizacao_usuario[]
  organizacoes_organizacoes_deleted_byTousuarios                   organizacoes[]           @relation("organizacoes_deleted_byTousuarios")
  planos_atualizados                                               planos_manutencao[]      @relation("planos_atualizado_por")
  planos_criados                                                   planos_manutencao[]      @relation("planos_criado_por")
  plantas_proprietario                                             plantas[]                @relation("plantas_proprietario")
  propostas_propostas_consultor_idTousuarios                       propostas[]              @relation("propostas_consultor_idTousuarios")
  propostas                                                        propostas[]
  prospects                                                        prospects[]
  rateios                                                          rateios[]
  tarefas_atualizadas                                              tarefas[]                @relation("tarefas_atualizado_por")
  tarefas_criadas                                                  tarefas[]                @relation("tarefas_criado_por")
  unidades_consumidoras_unidades_consumidoras_deleted_byTousuarios unidades_consumidoras[]  @relation("unidades_consumidoras_deleted_byTousuarios")
  unidades_consumidoras_unidades_consumidoras_usuario_idTousuarios unidades_consumidoras[]  @relation("unidades_consumidoras_usuario_idTousuarios")
  usuarios                                                         usuarios?                @relation("usuariosTousuarios", fields: [manager_id], references: [id], onUpdate: NoAction, map: "fk_usuarios_manager")
  other_usuarios                                                   usuarios[]               @relation("usuariosTousuarios")
  concessionarias                                                  concessionarias?         @relation(fields: [concessionaria_atual_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "usuarios_concessionaria_atual_id_foreign")
  organizacoes_usuarios_organizacao_atual_idToorganizacoes         organizacoes?            @relation("usuarios_organizacao_atual_idToorganizacoes", fields: [organizacao_atual_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "usuarios_organizacao_atual_id_foreign")
  ferramentas_responsavel              ferramentas[]            @relation("ferramentas_responsavel")
  ferramentas_criadas                  ferramentas[]            @relation("ferramentas_criado_por")
  ferramentas_atualizadas              ferramentas[]            @relation("ferramentas_atualizado_por")
  ferramentas_deletadas                ferramentas[]            @relation("ferramentas_deleted_by")
  historico_calibracoes_criadas        historico_calibracoes[]  @relation("historico_calibracoes_criado_por")
  historico_manutencoes_criadas        historico_manutencoes[]  @relation("historico_manutencoes_criado_por")
  historico_manutencoes_atualizadas    historico_manutencoes[]  @relation("historico_manutencoes_atualizado_por")

  @@index([email], map: "idx_usuarios_email")
  @@index([manager_id], map: "idx_usuarios_manager")
  @@index([role], map: "idx_usuarios_role")
  @@index([pix], map: "idx_usuarios_pix")
}

model plantas {
  id                    String                 @id @default(cuid()) @db.Char(26)
  nome                  String                 @db.VarChar(255)
  cnpj                  String                 @unique @db.VarChar(255)
  localizacao           String                 @db.VarChar(255)
  horario_funcionamento String                 @db.VarChar(255)
  logradouro            String                 @db.VarChar(255)
  bairro                String?                @db.VarChar(255)
  cidade                String                 @db.VarChar(255)
  uf                    String                 @db.VarChar(2)
  cep                   String                 @db.VarChar(255)
  proprietario_id       String                 @db.Char(26)
  created_at            DateTime?              @db.Timestamp(0)
  updated_at            DateTime?              @db.Timestamp(0)
  deleted_at            DateTime?              @db.Timestamp(0)
  anomalias             anomalias[]
  equipamentos          equipamentos[]
  proprietario          usuarios               @relation("plantas_proprietario", fields: [proprietario_id], references: [id])
  tarefas               tarefas[]
  feriado_plantas       feriado_plantas[]
  configuracao_plantas  configuracao_plantas[]
  programacoes_os       programacoes_os[]
  ordens_servico        ordens_servico[]

  @@index([proprietario_id])
  @@index([cidade, uf])
  @@map("plantas")
}

model equipamentos {
  id                     String                        @id @default(cuid()) @db.Char(26)
  nome                   String                        @db.VarChar(255)
  classificacao          String                        @db.VarChar(10)
  planta_id              String?                       @db.Char(26)
  proprietario_id        String?                       @db.Char(26)
  equipamento_pai_id     String?                       @db.Char(26)
  fabricante             String?                       @db.VarChar(255)
  modelo                 String?                       @db.VarChar(255)
  numero_serie           String?                       @db.VarChar(255)
  criticidade            String                        @db.VarChar(1)
  tipo_equipamento       String?                       @db.VarChar(100)
  em_operacao            String?                       @db.VarChar(10)
  tipo_depreciacao       String?                       @db.VarChar(20)
  data_imobilizacao      DateTime?                     @db.Date
  data_instalacao        DateTime?                     @db.Date
  valor_imobilizado      Decimal?                      @db.Decimal(15, 2)
  valor_depreciacao      Decimal?                      @db.Decimal(15, 2)
  valor_contabil         Decimal?                      @db.Decimal(15, 2)
  vida_util              Int?
  fornecedor             String?                       @db.VarChar(255)
  centro_custo           String?                       @db.VarChar(100)
  plano_manutencao       String?                       @db.VarChar(100)
  localizacao            String?                       @db.VarChar(255)
  localizacao_especifica String?                       @db.VarChar(500)
  observacoes            String?
  mcpse                  Boolean?                      @default(false)
  tuc                    String?                       @db.VarChar(100)
  a1                     String?                       @db.VarChar(100)
  a2                     String?                       @db.VarChar(100)
  a3                     String?                       @db.VarChar(100)
  a4                     String?                       @db.VarChar(100)
  a5                     String?                       @db.VarChar(100)
  a6                     String?                       @db.VarChar(100)
  created_at             DateTime                      @default(now()) @db.Timestamp(0)
  updated_at             DateTime                      @updatedAt @db.Timestamp(0)
  deleted_at             DateTime?                     @db.Timestamp(0)
  anomalias              anomalias[]
  equipamento_pai        equipamentos?                 @relation("EquipamentoUAR", fields: [equipamento_pai_id], references: [id], onDelete: Restrict)
  componentes_uar        equipamentos[]                @relation("EquipamentoUAR")
  planta                 plantas?                      @relation(fields: [planta_id], references: [id], onDelete: Restrict)
  proprietario           usuarios?                     @relation("EquipamentoProprietario", fields: [proprietario_id], references: [id], onDelete: Restrict)
  dados_tecnicos         equipamentos_dados_tecnicos[]
  planos_manutencao      planos_manutencao?
  tarefas                tarefas[]
  programacoes_os        programacoes_os[]
  ordens_servico         ordens_servico[]

  @@index([planta_id])
  @@index([proprietario_id])
  @@index([equipamento_pai_id])
  @@index([classificacao])
  @@index([criticidade])
  @@index([deleted_at])
  @@map("equipamentos")
}

model equipamentos_dados_tecnicos {
  id             String       @id @default(cuid()) @db.Char(26)
  equipamento_id String       @db.Char(26)
  campo          String       @db.VarChar(100)
  valor          String?
  tipo           String       @db.VarChar(20)
  unidade        String?      @db.VarChar(20)
  created_at     DateTime     @default(now()) @db.Timestamp(0)
  updated_at     DateTime     @updatedAt @db.Timestamp(0)
  equipamento    equipamentos @relation(fields: [equipamento_id], references: [id], onDelete: Cascade)

  @@index([equipamento_id])
  @@index([campo])
  @@map("equipamentos_dados_tecnicos")
}

model anomalias {
  id               String                @id @default(cuid()) @db.Char(26)
  descricao        String
  local            String                @db.VarChar(255)
  ativo            String                @db.VarChar(255)
  data             DateTime              @default(now()) @db.Timestamp(0)
  condicao         CondicaoAnomalia      @default(FUNCIONANDO)
  origem           OrigemAnomalia
  status           StatusAnomalia        @default(AGUARDANDO)
  prioridade       PrioridadeAnomalia    @default(MEDIA)
  observacoes      String?
  criado_por       String?               @db.VarChar(255)
  ordem_servico_id String?               @db.VarChar(50)
  planta_id        String?               @db.Char(26)
  equipamento_id   String?               @db.Char(26)
  usuario_id       String?               @db.Char(26)
  created_at       DateTime              @default(now()) @db.Timestamp(0)
  updated_at       DateTime              @updatedAt @db.Timestamp(0)
  deleted_at       DateTime?             @db.Timestamp(0)
  anexos           anexos_anomalias[]
  equipamento      equipamentos?         @relation(fields: [equipamento_id], references: [id])
  planta           plantas?              @relation(fields: [planta_id], references: [id])
  usuario          usuarios?             @relation("anomalias_usuario", fields: [usuario_id], references: [id])
  historico        historico_anomalias[]
  programacoes_os  programacoes_os[]
  ordens_servico   ordens_servico[]

  @@index([status])
  @@index([prioridade])
  @@index([data])
  @@index([planta_id])
  @@index([equipamento_id])
  @@index([usuario_id])
  @@index([created_at])
  @@index([deleted_at])
  @@map("anomalias")
}

model historico_anomalias {
  id              String    @id @default(cuid()) @db.Char(26)
  acao            String    @db.VarChar(255)
  usuario         String    @db.VarChar(255)
  data            DateTime  @default(now()) @db.Timestamp(0)
  observacoes     String?
  status_anterior String?   @db.VarChar(50)
  status_novo     String?   @db.VarChar(50)
  anomalia_id     String    @db.Char(26)
  created_at      DateTime  @default(now()) @db.Timestamp(0)
  updated_at      DateTime  @updatedAt @db.Timestamp(0)
  anomalia        anomalias @relation(fields: [anomalia_id], references: [id], onDelete: Cascade)

  @@index([anomalia_id])
  @@index([data])
  @@map("historico_anomalias")
}

model anexos_anomalias {
  id            String    @id @default(cuid()) @db.Char(26)
  nome          String    @db.VarChar(255)
  nome_original String    @db.VarChar(255)
  tipo          String    @db.VarChar(100)
  mime_type     String    @db.VarChar(255)
  tamanho       BigInt
  descricao     String?
  caminho_s3    String    @db.VarChar(500)
  url_download  String?   @db.VarChar(500)
  anomalia_id   String    @db.Char(26)
  usuario_id    String?   @db.Char(26)
  created_at    DateTime  @default(now()) @db.Timestamp(0)
  updated_at    DateTime  @updatedAt @db.Timestamp(0)
  deleted_at    DateTime? @db.Timestamp(0)
  anomalia      anomalias @relation(fields: [anomalia_id], references: [id], onDelete: Cascade)
  usuario       usuarios? @relation("anexos_anomalias_usuario", fields: [usuario_id], references: [id])

  @@index([anomalia_id])
  @@index([tipo])
  @@index([created_at])
  @@index([deleted_at])
  @@map("anexos_anomalias")
}

model planos_manutencao {
  id                   String            @id @default(cuid()) @db.Char(26)
  equipamento_id       String            @unique @db.Char(26)
  nome                 String            @db.VarChar(200)
  descricao            String?
  versao               String            @default("1.0") @db.VarChar(20)
  status               StatusPlano       @default(ATIVO)
  ativo                Boolean           @default(true)
  data_vigencia_inicio DateTime?         @db.Timestamp(0)
  data_vigencia_fim    DateTime?         @db.Timestamp(0)
  observacoes          String?
  created_at           DateTime          @default(now()) @db.Timestamp(0)
  updated_at           DateTime          @updatedAt @db.Timestamp(0)
  deleted_at           DateTime?         @db.Timestamp(0)
  criado_por           String?           @db.Char(26)
  atualizado_por       String?           @db.Char(26)
  usuario_atualizador  usuarios?         @relation("planos_atualizado_por", fields: [atualizado_por], references: [id])
  usuario_criador      usuarios?         @relation("planos_criado_por", fields: [criado_por], references: [id])
  equipamento          equipamentos      @relation(fields: [equipamento_id], references: [id])
  tarefas              tarefas[]
  programacoes_os      programacoes_os[]
  ordens_servico       ordens_servico[]

  @@index([status, ativo])
  @@index([deleted_at])
}

model tarefas {
  id                       String            @id @default(cuid()) @db.Char(26)
  plano_manutencao_id      String            @db.Char(26)
  tag                      String            @unique @db.VarChar(50)
  nome                     String            @db.VarChar(200)
  descricao                String
  categoria                CategoriaTarefa
  tipo_manutencao          TipoManutencao
  frequencia               FrequenciaTarefa
  frequencia_personalizada Int?
  condicao_ativo           CondicaoAtivo
  criticidade              Int               @db.SmallInt
  duracao_estimada         Decimal           @db.Decimal(5, 2)
  tempo_estimado           Int
  ordem                    Int               @db.SmallInt
  planta_id                String?           @db.Char(26)
  equipamento_id           String            @db.Char(26)
  planejador               String?           @db.VarChar(100)
  responsavel              String?           @db.VarChar(100)
  observacoes              String?
  status                   StatusTarefa      @default(ATIVA)
  ativo                    Boolean           @default(true)
  created_at               DateTime          @default(now()) @db.Timestamp(0)
  updated_at               DateTime          @updatedAt @db.Timestamp(0)
  deleted_at               DateTime?         @db.Timestamp(0)
  criado_por               String?           @db.Char(26)
  atualizado_por           String?           @db.Char(26)
  anexos                   anexos_tarefa[]
  recursos                 recursos_tarefa[]
  sub_tarefas              sub_tarefas[]
  usuario_atualizador      usuarios?         @relation("tarefas_atualizado_por", fields: [atualizado_por], references: [id])
  usuario_criador          usuarios?         @relation("tarefas_criado_por", fields: [criado_por], references: [id])
  equipamento              equipamentos      @relation(fields: [equipamento_id], references: [id])
  plano_manutencao         planos_manutencao @relation(fields: [plano_manutencao_id], references: [id], onDelete: Cascade)
  planta                   plantas?          @relation(fields: [planta_id], references: [id])
  data_ultima_execucao     DateTime?         @db.Timestamp(0)
  numero_execucoes         Int               @default(0)
  tarefas_programacao_os tarefas_programacao_os[]
  tarefas_os            tarefas_os[]

  @@index([plano_manutencao_id, ordem])
  @@index([status, ativo])
  @@index([equipamento_id])
  @@index([categoria, tipo_manutencao])
  @@index([deleted_at])
}

model sub_tarefas {
  id             String   @id @default(cuid()) @db.Char(26)
  tarefa_id      String   @db.Char(26)
  descricao      String
  obrigatoria    Boolean  @default(false)
  tempo_estimado Int?
  ordem          Int      @db.SmallInt
  created_at     DateTime @default(now()) @db.Timestamp(0)
  updated_at     DateTime @updatedAt @db.Timestamp(0)
  tarefa         tarefas  @relation(fields: [tarefa_id], references: [id], onDelete: Cascade)

  @@index([tarefa_id, ordem])
}

model recursos_tarefa {
  id          String      @id @default(cuid()) @db.Char(26)
  tarefa_id   String      @db.Char(26)
  tipo        TipoRecurso
  descricao   String      @db.VarChar(200)
  quantidade  Decimal?    @db.Decimal(10, 3)
  unidade     String?     @db.VarChar(20)
  obrigatorio Boolean     @default(false)
  created_at  DateTime    @default(now()) @db.Timestamp(0)
  updated_at  DateTime    @updatedAt @db.Timestamp(0)
  tarefa      tarefas     @relation(fields: [tarefa_id], references: [id], onDelete: Cascade)

  @@index([tarefa_id, tipo])
}

model anexos_tarefa {
  id           String    @id @default(cuid()) @db.Char(26)
  tarefa_id    String    @db.Char(26)
  nome         String    @db.VarChar(255)
  tipo         TipoAnexo
  url          String
  tamanho      Int?
  content_type String?   @db.VarChar(100)
  created_at   DateTime  @default(now()) @db.Timestamp(0)
  updated_at   DateTime  @updatedAt @db.Timestamp(0)
  tarefa       tarefas   @relation(fields: [tarefa_id], references: [id], onDelete: Cascade)

  @@index([tarefa_id])
}

enum StatusAnomalia {
  AGUARDANDO
  EM_ANALISE
  OS_GERADA
  CANCELADA
  RESOLVIDA
}

enum PrioridadeAnomalia {
  BAIXA
  MEDIA
  ALTA
  CRITICA
}

enum CondicaoAnomalia {
  PARADO
  FUNCIONANDO
  RISCO_ACIDENTE
}

enum OrigemAnomalia {
  SCADA
  OPERADOR
  FALHA
}

enum StatusTarefa {
  ATIVA
  INATIVA
  EM_REVISAO
  ARQUIVADA
}

enum TipoManutencao {
  PREVENTIVA
  PREDITIVA
  CORRETIVA
  INSPECAO
  VISITA_TECNICA
}

enum CategoriaTarefa {
  MECANICA
  ELETRICA
  INSTRUMENTACAO
  LUBRIFICACAO
  LIMPEZA
  INSPECAO
  CALIBRACAO
  OUTROS
}

enum FrequenciaTarefa {
  DIARIA
  SEMANAL
  QUINZENAL
  MENSAL
  BIMESTRAL
  TRIMESTRAL
  SEMESTRAL
  ANUAL
  PERSONALIZADA
}

enum CondicaoAtivo {
  PARADO
  FUNCIONANDO
  QUALQUER
}

enum TipoRecurso {
  PECA
  MATERIAL
  FERRAMENTA
  TECNICO
  VIATURA
}

enum TipoAnexo {
  MANUAL
  PROCEDIMENTO
  MODELO_RELATORIO
  OUTROS
}

enum StatusPlano {
  ATIVO
  INATIVO
  EM_REVISAO
  ARQUIVADO
}

enum TipoFeriado {
  NACIONAL
  ESTADUAL
  MUNICIPAL
  PERSONALIZADO
}

model feriados {
  id         String      @id @default(cuid()) @db.Char(26)
  nome       String      @db.VarChar(255)
  data       DateTime    @db.Date
  tipo       TipoFeriado
  geral      Boolean     @default(false)
  recorrente Boolean     @default(false)
  descricao  String?     @db.Text
  ativo      Boolean     @default(true)
  created_at DateTime?   @default(now()) @db.Timestamp(0)
  updated_at DateTime?   @updatedAt @db.Timestamp(0)

  feriado_plantas feriado_plantas[]

  @@index([data])
  @@index([geral])
  @@index([ativo])
}

model feriado_plantas {
  feriado_id String    @db.Char(26)
  planta_id  String    @db.Char(26)
  created_at DateTime? @default(now()) @db.Timestamp(0)

  feriados feriados @relation(fields: [feriado_id], references: [id], onDelete: Cascade)
  plantas  plantas  @relation(fields: [planta_id], references: [id], onDelete: Cascade)

  @@id([feriado_id, planta_id])
}

model configuracoes_dias_uteis {
  id         String    @id @default(cuid()) @db.Char(26)
  nome       String    @db.VarChar(255)
  descricao  String?   @db.Text
  segunda    Boolean   @default(true)
  terca      Boolean   @default(true)
  quarta     Boolean   @default(true)
  quinta     Boolean   @default(true)
  sexta      Boolean   @default(true)
  sabado     Boolean   @default(false)
  domingo    Boolean   @default(false)
  geral      Boolean   @default(false)
  ativo      Boolean   @default(true)
  created_at DateTime? @default(now()) @db.Timestamp(0)
  updated_at DateTime? @updatedAt @db.Timestamp(0)

  configuracao_plantas configuracao_plantas[]

  @@index([geral])
  @@index([ativo])
}

model configuracao_plantas {
  configuracao_id String    @db.Char(26)
  planta_id       String    @db.Char(26)
  created_at      DateTime? @default(now()) @db.Timestamp(0)

  configuracoes configuracoes_dias_uteis @relation(fields: [configuracao_id], references: [id], onDelete: Cascade)
  plantas       plantas                  @relation(fields: [planta_id], references: [id], onDelete: Cascade)

  @@id([configuracao_id, planta_id])
}

// ========================================
// MÓDULO VEÍCULOS - SCHEMAS PRISMA
// ========================================

// Enum para status do veículo
enum StatusVeiculo {
  disponivel @map("disponivel")
  em_uso     @map("em_uso")
  manutencao @map("manutencao")
  inativo    @map("inativo")

  @@map("status_veiculo")
}

// Enum para tipo de veículo
enum TipoVeiculo {
  carro       @map("carro")
  van         @map("van")
  caminhonete @map("caminhonete")
  caminhao    @map("caminhao")
  moto        @map("moto")
  onibus      @map("onibus")
  utilitario  @map("utilitario")

  @@map("tipo_veiculo")
}

// Enum para tipo de combustível
enum TipoCombustivel {
  gasolina @map("gasolina")
  etanol   @map("etanol")
  diesel   @map("diesel")
  flex     @map("flex")
  eletrico @map("eletrico")
  hibrido  @map("hibrido")
  gnv      @map("gnv")

  @@map("tipo_combustivel")
}

// Enum para tipo de documentação
enum TipoDocumentacaoVeiculo {
  ipva          @map("ipva")
  seguro        @map("seguro")
  licenciamento @map("licenciamento")
  revisao       @map("revisao")
  multa         @map("multa")
  outros        @map("outros")

  @@map("tipo_documentacao_veiculo")
}

// Tabela principal de veículos
model veiculo {
  id            String   @id @default(cuid())
  criado_em     DateTime @default(now()) @map("criado_em")
  atualizado_em DateTime @updatedAt @map("atualizado_em")

  // Identificação básica
  nome               String  @db.VarChar(100)
  codigo_patrimonial String? @unique @map("codigo_patrimonial") @db.VarChar(50)
  placa              String  @unique @db.VarChar(8)

  // Especificações do veículo
  marca          String  @db.VarChar(50)
  modelo         String  @db.VarChar(100)
  ano_fabricacao Int     @map("ano_fabricacao")
  ano_modelo     Int?    @map("ano_modelo")
  cor            String? @db.VarChar(30)
  chassi         String? @unique @db.VarChar(17)
  renavam        String? @unique @map("renavam") @db.VarChar(11)

  // Tipo e combustível
  tipo             TipoVeiculo
  tipo_combustivel TipoCombustivel @map("tipo_combustivel")

  // Capacidades
  capacidade_passageiros Int      @default(0) @map("capacidade_passageiros")
  capacidade_carga       Decimal  @default(0) @map("capacidade_carga") @db.Decimal(10, 2) // em kg
  autonomia_media        Decimal? @map("autonomia_media") @db.Decimal(5, 2) // km/l

  // Status e localização
  status            StatusVeiculo @default(disponivel)
  localizacao_atual String        @map("localizacao_atual") @db.VarChar(200)

  // Valor de aquisição (opcional para controle patrimonial)
  valor_aquisicao Decimal?  @map("valor_aquisicao") @db.Decimal(12, 2)
  data_aquisicao  DateTime? @map("data_aquisicao")

  // Quilometragem e manutenção
  quilometragem   Int       @default(0)
  proxima_revisao DateTime? @map("proxima_revisao")
  ultima_revisao  DateTime? @map("ultima_revisao")

  // Responsável e observações
  responsavel    String  @db.VarChar(100)
  responsavel_id String? @map("responsavel_id") @db.Char(26) // Referência para usuarios.id
  observacoes    String? @db.Text
  foto           String? @db.Text // URL ou base64

  // Controle de ativo/inativo
  ativo             Boolean @default(true)
  motivo_inativacao String? @map("motivo_inativacao") @db.Text
  inativado_por     String? @map("inativado_por") @db.Char(26) // Referência para usuarios.id

  // Relacionamentos
  planta_id       String? @map("planta_id")
  proprietario_id String? @map("proprietario_id")

  // Referências externas (descomente quando necessário)
  // planta               plantas?                  @relation(fields: [planta_id], references: [id])
  // proprietario         usuarios?                 @relation("VeiculosProprietario", fields: [proprietario_id], references: [id])
  // responsavel_usuario   usuarios?                 @relation("VeiculosResponsavel", fields: [responsavel_id], references: [id])
  // inativado_por_usuario  usuarios?                 @relation("VeiculosInativadoPor", fields: [inativado_por], references: [id])

  // Relacionamentos com outras tabelas
  documentacao documentacao_veiculo[]
  reservas     reserva_veiculo[]

  @@index([status])
  @@index([placa])
  @@index([planta_id])
  @@index([responsavel])
  @@index([tipo])
  @@index([ativo])
  @@index([chassi])
  @@index([ano_fabricacao])
  @@map("veiculos")
}

// Tabela para documentação dos veículos (com upload de arquivos)
model documentacao_veiculo {
  id            String   @id @default(cuid())
  criado_em     DateTime @default(now()) @map("criado_em")
  atualizado_em DateTime @updatedAt @map("atualizado_em")

  veiculo_id       String                  @map("veiculo_id")
  tipo             TipoDocumentacaoVeiculo
  descricao        String                  @db.VarChar(200)
  data_vencimento  DateTime                @map("data_vencimento")
  data_emissao     DateTime?               @map("data_emissao")
  valor            Decimal?                @db.Decimal(10, 2)
  numero_documento String?                 @map("numero_documento") @db.VarChar(50)
  orgao_emissor    String?                 @map("orgao_emissor") @db.VarChar(100)

  // Upload de arquivos
  nome_arquivo    String? @map("nome_arquivo") @db.VarChar(255)
  caminho_arquivo String? @map("caminho_arquivo") @db.VarChar(500)
  tamanho_arquivo Int?    @map("tamanho_arquivo") // em bytes
  tipo_arquivo    String? @map("tipo_arquivo") @db.VarChar(50) // PDF, JPG, PNG, etc.
  hash_arquivo    String? @map("hash_arquivo") @db.VarChar(64) // para verificação de integridade

  // Metadados do upload
  upload_por    String?   @map("upload_por") @db.VarChar(100)
  upload_por_id String?   @map("upload_por_id") @db.Char(26) // Referência para usuarios.id
  data_upload   DateTime? @map("data_upload")

  observacoes String? @db.Text

  // Status do documento
  ativo      Boolean @default(true)
  notificado Boolean @default(false) // Para controle de notificações de vencimento

  // Relacionamento
  veiculo veiculo @relation(fields: [veiculo_id], references: [id], onDelete: Cascade)

  @@index([veiculo_id])
  @@index([data_vencimento])
  @@index([tipo])
  @@index([ativo])
  @@map("documentacao_veiculos")
}

// ========================================
// TABELAS DE RESERVAS (INTEGRAÇÃO)
// ========================================

// Enum para status das reservas
enum StatusReserva {
  ativa      @map("ativa")
  finalizada @map("finalizada")
  cancelada  @map("cancelada")
  vencida    @map("vencida")

  @@map("status_reserva")
}

// Enum para tipo de solicitante
enum TipoSolicitante {
  ordem_servico @map("ordem_servico")
  viagem        @map("viagem")
  manutencao    @map("manutencao")
  manual        @map("manual")

  @@map("tipo_solicitante")
}

// Tabela principal de reservas de veículos
model reserva_veiculo {
  id            String   @id @default(cuid())
  criado_em     DateTime @default(now()) @map("criado_em")
  atualizado_em DateTime @updatedAt @map("atualizado_em")

  // Relacionamento com veículo
  veiculo_id String  @map("veiculo_id")
  veiculo    veiculo @relation(fields: [veiculo_id], references: [id], onDelete: Cascade)

  // Identificação da reserva
  solicitante_id   String?         @map("solicitante_id") @db.VarChar(100)
  tipo_solicitante TipoSolicitante @map("tipo_solicitante")

  // Período da reserva
  data_inicio DateTime @map("data_inicio")
  data_fim    DateTime @map("data_fim")
  hora_inicio String   @map("hora_inicio") @db.VarChar(5) // HH:mm
  hora_fim    String   @map("hora_fim") @db.VarChar(5)

  // Responsável e finalidade
  responsavel    String  @db.VarChar(100)
  responsavel_id String? @map("responsavel_id") @db.Char(26) // Referência para usuarios.id
  finalidade     String  @db.Text

  // Status e controle
  status        StatusReserva @default(ativa)
  criado_por    String?       @map("criado_por") @db.VarChar(100)
  criado_por_id String?       @map("criado_por_id") @db.Char(26) // Referência para usuarios.id

  // Campos de cancelamento
  motivo_cancelamento String?   @map("motivo_cancelamento") @db.Text
  data_cancelamento   DateTime? @map("data_cancelamento")
  cancelado_por       String?   @map("cancelado_por") @db.VarChar(100)
  cancelado_por_id    String?   @map("cancelado_por_id") @db.Char(26) // Referência para usuarios.id

  // Campos de finalização
  data_finalizacao        DateTime? @map("data_finalizacao")
  finalizado_por          String?   @map("finalizado_por") @db.VarChar(100)
  finalizado_por_id       String?   @map("finalizado_por_id") @db.Char(26) // Referência para usuarios.id
  km_inicial              Int?      @map("km_inicial")
  km_final                Int?      @map("km_final")
  observacoes_finalizacao String?   @map("observacoes_finalizacao") @db.Text

  // Observações gerais
  observacoes String? @db.Text

  @@index([veiculo_id])
  @@index([solicitante_id])
  @@index([data_inicio])
  @@index([data_fim])
  @@index([status])
  @@index([tipo_solicitante])
  @@map("reservas_veiculos")
}

// ========================================
// MÓDULO PROGRAMAÇÃO E EXECUÇÃO DE OS
// ========================================

// Enums compartilhados
enum TipoOS {
  PREVENTIVA      @map("PREVENTIVA")
  PREDITIVA       @map("PREDITIVA")
  CORRETIVA       @map("CORRETIVA")
  INSPECAO        @map("INSPECAO")
  VISITA_TECNICA  @map("VISITA_TECNICA")

  @@map("tipo_os")
}

enum CondicaoOS {
  PARADO          @map("PARADO")
  FUNCIONANDO     @map("FUNCIONANDO")

  @@map("condicao_os")
}

enum PrioridadeOS {
  BAIXA           @map("BAIXA")
  MEDIA           @map("MEDIA")
  ALTA            @map("ALTA")
  CRITICA         @map("CRITICA")

  @@map("prioridade_os")
}

enum OrigemOS {
  ANOMALIA        @map("ANOMALIA")
  TAREFA          @map("TAREFA")
  PLANO_MANUTENCAO @map("PLANO_MANUTENCAO")
  MANUAL          @map("MANUAL")

  @@map("origem_os")
}

// Enums específicos para Programação
enum StatusProgramacaoOS {
  RASCUNHO        @map("RASCUNHO")
  PENDENTE        @map("PENDENTE")
  EM_ANALISE      @map("EM_ANALISE")
  APROVADA        @map("APROVADA")
  REJEITADA       @map("REJEITADA")
  CANCELADA       @map("CANCELADA")

  @@map("status_programacao_os")
}

// Enums específicos para Ordem de Serviço
enum StatusOS {
  PLANEJADA       @map("PLANEJADA")      // OS criada da programação aprovada
  PROGRAMADA      @map("PROGRAMADA")     // Data/hora definida, recursos confirmados
  EM_EXECUCAO     @map("EM_EXECUCAO")    // Execução iniciada
  PAUSADA         @map("PAUSADA")        // Execução pausada
  FINALIZADA      @map("FINALIZADA")     // Execução concluída
  CANCELADA       @map("CANCELADA")      // OS cancelada

  @@map("status_os")
}

enum TipoAnexoOS {
  FOTO_ANTES      @map("FOTO_ANTES")
  FOTO_DURANTE    @map("FOTO_DURANTE")
  FOTO_DEPOIS     @map("FOTO_DEPOIS")
  DOCUMENTO       @map("DOCUMENTO")
  LAUDO           @map("LAUDO")
  CERTIFICADO     @map("CERTIFICADO")
  MANUAL          @map("MANUAL")

  @@map("tipo_anexo_os")
}

// ========================================
// 1. PROGRAMAÇÃO DE OS
// ========================================

// Tabela principal para programação de OS
model programacoes_os {
  id                    String                    @id @default(cuid())
  criado_em             DateTime                  @default(now()) @map("criado_em")
  atualizado_em         DateTime                  @updatedAt @map("atualizado_em")
  deletado_em           DateTime?                 @map("deletado_em")

  // Identificação
  codigo                String                    @unique @db.VarChar(50) // PRG-2025-001
  descricao             String                    @db.Text
  local                 String                    @db.VarChar(255)
  ativo                 String                    @db.VarChar(255)

  // Classificação
  condicoes             CondicaoOS
  status                StatusProgramacaoOS       @default(PENDENTE)
  tipo                  TipoOS
  prioridade            PrioridadeOS              @default(MEDIA)
  origem                OrigemOS

  // Relacionamentos com origem
  planta_id             String?                   @map("planta_id") @db.Char(26)
  equipamento_id        String?                   @map("equipamento_id") @db.Char(26)
  anomalia_id           String?                   @map("anomalia_id") @db.Char(26)
  plano_manutencao_id   String?                   @map("plano_manutencao_id") @db.Char(26)
  
  // REMOVIDO: tarefa_id - agora será relacionamento N:N

  // Dados da origem (JSON para flexibilidade)
  dados_origem          Json?                     @map("dados_origem")

  // Planejamento
  data_previsao_inicio  DateTime?                 @map("data_previsao_inicio") @db.Timestamp(0)
  data_previsao_fim     DateTime?                 @map("data_previsao_fim") @db.Timestamp(0)
  tempo_estimado        Decimal                   @map("tempo_estimado") @db.Decimal(5,2) // em horas
  duracao_estimada      Decimal                   @map("duracao_estimada") @db.Decimal(5,2) // em horas

  // Requisitos de veículo (não a reserva real)
  necessita_veiculo     Boolean                   @default(false) @map("necessita_veiculo")
  assentos_necessarios  Int?                      @map("assentos_necessarios")
  carga_necessaria      Decimal?                  @map("carga_necessaria") @db.Decimal(8,2) // em kg
  observacoes_veiculo   String?                   @map("observacoes_veiculo") @db.Text

  // Programação inicial
  data_hora_programada  DateTime?                 @map("data_hora_programada") @db.Timestamp(0)
  responsavel           String?                   @db.VarChar(255)
  responsavel_id        String?                   @map("responsavel_id") @db.Char(26)
  time_equipe           String?                   @map("time_equipe") @db.VarChar(255)

  // Custos estimados
  orcamento_previsto    Decimal?                  @map("orcamento_previsto") @db.Decimal(12,2)

  // Observações e justificativas
  observacoes           String?                   @db.Text
  observacoes_programacao String?                 @map("observacoes_programacao") @db.Text
  justificativa         String?                   @db.Text
  motivo_rejeicao       String?                   @map("motivo_rejeicao") @db.Text
  motivo_cancelamento   String?                   @map("motivo_cancelamento") @db.Text

  // Auditoria
  criado_por            String?                   @map("criado_por") @db.VarChar(255)
  criado_por_id         String?                   @map("criado_por_id") @db.Char(26)
  analisado_por         String?                   @map("analisado_por") @db.VarChar(255)
  analisado_por_id      String?                   @map("analisado_por_id") @db.Char(26)
  data_analise          DateTime?                 @map("data_analise")
  aprovado_por          String?                   @map("aprovado_por") @db.VarChar(255)
  aprovado_por_id       String?                   @map("aprovado_por_id") @db.Char(26)
  data_aprovacao        DateTime?                 @map("data_aprovacao")

  // Relacionamentos
  planta                plantas?                  @relation(fields: [planta_id], references: [id])
  equipamento           equipamentos?             @relation(fields: [equipamento_id], references: [id])
  anomalia              anomalias?                @relation(fields: [anomalia_id], references: [id])
  plano_manutencao      planos_manutencao?        @relation(fields: [plano_manutencao_id], references: [id])

  // Relacionamentos internos
  materiais             materiais_programacao_os[]
  ferramentas           ferramentas_programacao_os[]
  tecnicos              tecnicos_programacao_os[]
  historico             historico_programacao_os[]
  tarefas_programacao   tarefas_programacao_os[]  // NOVO: N:N com tarefas

  // Relacionamento com OS gerada
  ordem_servico         ordens_servico?

  @@map("programacoes_os")
  @@index([codigo])
  @@index([status])
  @@index([tipo])
  @@index([prioridade])
  @@index([origem])
  @@index([data_hora_programada])
  @@index([planta_id])
  @@index([equipamento_id])
  @@index([anomalia_id])
  @@index([deletado_em])
}

// Materiais planejados para programação
model materiais_programacao_os {
  id                    String              @id @default(cuid())
  programacao_id        String              @map("programacao_id")
  descricao             String              @db.VarChar(255)
  quantidade_planejada  Decimal             @map("quantidade_planejada") @db.Decimal(10,3)
  unidade               String              @db.VarChar(20)
  custo_unitario        Decimal?            @map("custo_unitario") @db.Decimal(10,2)
  custo_total           Decimal?            @map("custo_total") @db.Decimal(12,2)
  confirmado            Boolean             @default(false)
  disponivel            Boolean             @default(true)
  observacoes           String?             @db.Text
  created_at            DateTime            @default(now()) @map("created_at")
  updated_at            DateTime            @updatedAt @map("updated_at")

  programacao           programacoes_os     @relation(fields: [programacao_id], references: [id], onDelete: Cascade)

  @@map("materiais_programacao_os")
  @@index([programacao_id])
}

// Ferramentas planejadas para programação
model ferramentas_programacao_os {
  id                    String              @id @default(cuid())
  programacao_id        String              @map("programacao_id")
  descricao             String              @db.VarChar(255)
  quantidade            Int                 @default(1)
  confirmada            Boolean             @default(false)
  disponivel            Boolean             @default(true)
  observacoes           String?             @db.Text
  created_at            DateTime            @default(now()) @map("created_at")
  updated_at            DateTime            @updatedAt @map("updated_at")

  programacao           programacoes_os     @relation(fields: [programacao_id], references: [id], onDelete: Cascade)

  @@map("ferramentas_programacao_os")
  @@index([programacao_id])
}

// Técnicos planejados para programação
model tecnicos_programacao_os {
  id                    String              @id @default(cuid())
  programacao_id        String              @map("programacao_id")
  nome                  String              @db.VarChar(255)
  especialidade         String              @db.VarChar(100)
  horas_estimadas       Decimal             @map("horas_estimadas") @db.Decimal(5,2)
  custo_hora            Decimal?            @map("custo_hora") @db.Decimal(8,2)
  custo_total           Decimal?            @map("custo_total") @db.Decimal(12,2)
  disponivel            Boolean             @default(true)
  tecnico_id            String?             @map("tecnico_id") @db.Char(26)
  created_at            DateTime            @default(now()) @map("created_at")
  updated_at            DateTime            @updatedAt @map("updated_at")

  programacao           programacoes_os     @relation(fields: [programacao_id], references: [id], onDelete: Cascade)

  @@map("tecnicos_programacao_os")
  @@index([programacao_id])
  @@index([tecnico_id])
}

// Histórico da programação
model historico_programacao_os {
  id                      String                  @id @default(cuid())
  programacao_id          String                  @map("programacao_id")
  acao                    String                  @db.VarChar(255)
  usuario                 String                  @db.VarChar(255)
  usuario_id              String?                 @map("usuario_id") @db.Char(26)
  data                    DateTime                @default(now())
  observacoes             String?                 @db.Text
  status_anterior         StatusProgramacaoOS?    @map("status_anterior")
  status_novo             StatusProgramacaoOS?    @map("status_novo")
  dados_extras            Json?                   @map("dados_extras")

  programacao             programacoes_os         @relation(fields: [programacao_id], references: [id], onDelete: Cascade)

  @@map("historico_programacao_os")
  @@index([programacao_id])
  @@index([data])
}

// ========================================
// 2. ORDENS DE SERVIÇO (EXECUÇÃO)
// ========================================

// Tabela principal de Ordens de Serviço
model ordens_servico {
  id                    String         @id @default(cuid())
  criado_em             DateTime       @default(now()) @map("criado_em")
  atualizado_em         DateTime       @updatedAt @map("atualizado_em")
  deletado_em           DateTime?      @map("deletado_em")

  // Relacionamento com programação
  programacao_id        String         @unique @map("programacao_id") // Uma OS vem de uma programação

  // Identificação
  numero_os             String         @unique @map("numero_os") @db.VarChar(50) // OS-2025-001
  descricao             String         @db.Text
  local                 String         @db.VarChar(255)
  ativo                 String         @db.VarChar(255)
  
  // Classificação (copiada da programação)
  condicoes             CondicaoOS
  status                StatusOS       @default(PLANEJADA)
  tipo                  TipoOS
  prioridade            PrioridadeOS
  origem                OrigemOS

  // Dados herdados da programação
  planta_id             String?        @map("planta_id") @db.Char(26)
  equipamento_id        String?        @map("equipamento_id") @db.Char(26)
  anomalia_id           String?        @map("anomalia_id") @db.Char(26)
  plano_manutencao_id   String?        @map("plano_manutencao_id") @db.Char(26)
  dados_origem          Json?          @map("dados_origem")
  
  // REMOVIDO: tarefa_id - agora será relacionamento N:N

  // Planejamento (da programação)
  tempo_estimado        Decimal        @map("tempo_estimado") @db.Decimal(5,2)
  duracao_estimada      Decimal        @map("duracao_estimada") @db.Decimal(5,2)

  // Programação definitiva
  data_hora_programada  DateTime?      @map("data_hora_programada") @db.Timestamp(0)
  responsavel           String         @db.VarChar(255)
  responsavel_id        String?        @map("responsavel_id") @db.Char(26)
  time_equipe           String?        @map("time_equipe") @db.VarChar(255)

  // Execução Real
  data_hora_inicio_real DateTime?      @map("data_hora_inicio_real") @db.Timestamp(0)
  data_hora_fim_real    DateTime?      @map("data_hora_fim_real") @db.Timestamp(0)

  // Equipe presente na execução
  equipe_presente       Json?          @map("equipe_presente") // Array de strings

  // Custos
  orcamento_previsto    Decimal?       @map("orcamento_previsto") @db.Decimal(12,2)
  custo_real            Decimal?       @map("custo_real") @db.Decimal(12,2)

  // Observações
  observacoes           String?        @db.Text
  observacoes_programacao String?     @map("observacoes_programacao") @db.Text
  observacoes_execucao  String?        @map("observacoes_execucao") @db.Text
  motivo_cancelamento   String?        @map("motivo_cancelamento") @db.Text

  // Resultados da execução
  resultado_servico     String?        @map("resultado_servico") @db.Text
  problemas_encontrados String?        @map("problemas_encontrados") @db.Text
  recomendacoes         String?        @db.Text
  proxima_manutencao    String?        @map("proxima_manutencao") @db.VarChar(255)

  // Qualidade
  avaliacao_qualidade   Int?           @map("avaliacao_qualidade") @db.SmallInt // 1-5
  observacoes_qualidade String?        @map("observacoes_qualidade") @db.Text

  // Auditoria
  criado_por            String?        @map("criado_por") @db.VarChar(255)
  criado_por_id         String?        @map("criado_por_id") @db.Char(26)
  programado_por        String?        @map("programado_por") @db.VarChar(255)
  programado_por_id     String?        @map("programado_por_id") @db.Char(26)
  finalizado_por        String?        @map("finalizado_por") @db.VarChar(255)
  finalizado_por_id     String?        @map("finalizado_por_id") @db.Char(26)
  aprovado_por          String?        @map("aprovado_por") @db.VarChar(255)
  aprovado_por_id       String?        @map("aprovado_por_id") @db.Char(26)
  data_aprovacao        DateTime?      @map("data_aprovacao")

  // Relacionamentos
  programacao           programacoes_os    @relation(fields: [programacao_id], references: [id])
  planta                plantas?           @relation(fields: [planta_id], references: [id])
  equipamento           equipamentos?      @relation(fields: [equipamento_id], references: [id])
  anomalia              anomalias?         @relation(fields: [anomalia_id], references: [id])
  plano_manutencao      planos_manutencao? @relation(fields: [plano_manutencao_id], references: [id])
  
  // Relacionamentos internos de execução
  materiais             materiais_os[]
  ferramentas           ferramentas_os[]
  tecnicos              tecnicos_os[]
  historico             historico_os[]
  checklist_atividades  checklist_atividades_os[]
  anexos                anexos_os[]
  registros_tempo       registros_tempo_os[]
  tarefas_os            tarefas_os[]       // NOVO: N:N com tarefas

  @@map("ordens_servico")
  @@index([numero_os])
  @@index([programacao_id])
  @@index([status])
  @@index([tipo])
  @@index([prioridade])
  @@index([data_hora_programada])
  @@index([planta_id])
  @@index([equipamento_id])
  @@index([deletado_em])
}

// ========================================
// TABELA DE RELACIONAMENTO N:N - TAREFAS
// ========================================

// Relacionamento entre programação e tarefas (N:N)
model tarefas_programacao_os {
  id             String              @id @default(cuid())
  programacao_id String              @map("programacao_id")
  tarefa_id      String              @map("tarefa_id") @db.Char(26)
  ordem          Int                 @default(0) // Ordem de execução
  status         String              @default("PENDENTE") @db.VarChar(20) // PENDENTE, CONCLUIDA, CANCELADA
  observacoes    String?             @db.Text
  created_at     DateTime            @default(now()) @map("created_at")
  updated_at     DateTime            @updatedAt @map("updated_at")

  // Relacionamentos
  programacao    programacoes_os     @relation(fields: [programacao_id], references: [id], onDelete: Cascade)
  tarefa         tarefas             @relation(fields: [tarefa_id], references: [id])

  @@unique([programacao_id, tarefa_id]) // Evitar duplicatas
  @@map("tarefas_programacao_os")
  @@index([programacao_id])
  @@index([tarefa_id])
}

// Relacionamento entre OS e tarefas (N:N) 
model tarefas_os {
  id             String              @id @default(cuid())
  os_id          String              @map("os_id")
  tarefa_id      String              @map("tarefa_id") @db.Char(26)
  ordem          Int                 @default(0) // Ordem de execução
  status         String              @default("PENDENTE") @db.VarChar(20) // PENDENTE, CONCLUIDA, CANCELADA
  data_conclusao DateTime?           @map("data_conclusao")
  concluida_por  String?             @map("concluida_por") @db.VarChar(255)
  observacoes    String?             @db.Text
  created_at     DateTime            @default(now()) @map("created_at")
  updated_at     DateTime            @updatedAt @map("updated_at")

  // Relacionamentos
  ordem_servico  ordens_servico      @relation(fields: [os_id], references: [id], onDelete: Cascade)
  tarefa         tarefas             @relation(fields: [tarefa_id], references: [id])

  @@unique([os_id, tarefa_id]) // Evitar duplicatas
  @@map("tarefas_os")
  @@index([os_id])
  @@index([tarefa_id])
}

// Materiais consumidos na execução
model materiais_os {
  id                    String    @id @default(cuid())
  os_id                 String    @map("os_id")
  descricao             String    @db.VarChar(255)
  quantidade_planejada  Decimal   @map("quantidade_planejada") @db.Decimal(10,3)
  quantidade_consumida  Decimal?  @map("quantidade_consumida") @db.Decimal(10,3)
  unidade               String    @db.VarChar(20)
  custo_unitario        Decimal?  @map("custo_unitario") @db.Decimal(10,2)
  custo_total           Decimal?  @map("custo_total") @db.Decimal(12,2)
  confirmado            Boolean   @default(false)
  disponivel            Boolean   @default(true)
  observacoes           String?   @db.Text
  created_at            DateTime  @default(now()) @map("created_at")
  updated_at            DateTime  @updatedAt @map("updated_at")

  ordem_servico         ordens_servico @relation(fields: [os_id], references: [id], onDelete: Cascade)

  @@map("materiais_os")
  @@index([os_id])
}

// Ferramentas utilizadas na execução
model ferramentas_os {
  id                    String    @id @default(cuid())
  os_id                 String    @map("os_id")
  descricao             String    @db.VarChar(255)
  quantidade            Int       @default(1)
  confirmada            Boolean   @default(false)
  disponivel            Boolean   @default(true)
  utilizada             Boolean   @default(false)
  condicao_antes        String?   @map("condicao_antes") @db.VarChar(50)
  condicao_depois       String?   @map("condicao_depois") @db.VarChar(50)
  observacoes           String?   @db.Text
  created_at            DateTime  @default(now()) @map("created_at")
  updated_at            DateTime  @updatedAt @map("updated_at")

  ordem_servico         ordens_servico @relation(fields: [os_id], references: [id], onDelete: Cascade)

  @@map("ferramentas_os")
  @@index([os_id])
}

// Técnicos na execução
model tecnicos_os {
  id                    String    @id @default(cuid())
  os_id                 String    @map("os_id")
  nome                  String    @db.VarChar(255)
  especialidade         String    @db.VarChar(100)
  horas_estimadas       Decimal   @map("horas_estimadas") @db.Decimal(5,2)
  horas_trabalhadas     Decimal?  @map("horas_trabalhadas") @db.Decimal(5,2)
  custo_hora            Decimal?  @map("custo_hora") @db.Decimal(8,2)
  custo_total           Decimal?  @map("custo_total") @db.Decimal(12,2)
  disponivel            Boolean   @default(true)
  presente              Boolean   @default(false)
  tecnico_id            String?   @map("tecnico_id") @db.Char(26)
  created_at            DateTime  @default(now()) @map("created_at")
  updated_at            DateTime  @updatedAt @map("updated_at")

  ordem_servico         ordens_servico @relation(fields: [os_id], references: [id], onDelete: Cascade)

  @@map("tecnicos_os")
  @@index([os_id])
  @@index([tecnico_id])
}

// Histórico das OS
model historico_os {
  id                    String         @id @default(cuid())
  os_id                 String         @map("os_id")
  acao                  String         @db.VarChar(255)
  usuario               String         @db.VarChar(255)
  usuario_id            String?        @map("usuario_id") @db.Char(26)
  data                  DateTime       @default(now())
  observacoes           String?        @db.Text
  status_anterior       StatusOS?      @map("status_anterior")
  status_novo           StatusOS?      @map("status_novo")
  dados_extras          Json?          @map("dados_extras")

  ordem_servico         ordens_servico @relation(fields: [os_id], references: [id], onDelete: Cascade)

  @@map("historico_os")
  @@index([os_id])
  @@index([data])
}

// Checklist de atividades
model checklist_atividades_os {
  id                    String         @id @default(cuid())
  os_id                 String         @map("os_id")
  atividade             String         @db.VarChar(500)
  ordem                 Int            @default(0)
  concluida             Boolean        @default(false)
  obrigatoria           Boolean        @default(false)
  tempo_estimado        Int?           @map("tempo_estimado") // em minutos
  observacoes           String?        @db.Text
  concluida_em          DateTime?      @map("concluida_em")
  concluida_por         String?        @map("concluida_por") @db.VarChar(255)
  concluida_por_id      String?        @map("concluida_por_id") @db.Char(26)
  created_at            DateTime       @default(now()) @map("created_at")
  updated_at            DateTime       @updatedAt @map("updated_at")

  ordem_servico         ordens_servico @relation(fields: [os_id], references: [id], onDelete: Cascade)

  @@map("checklist_atividades_os")
  @@index([os_id])
  @@index([ordem])
}

// Anexos da OS
model anexos_os {
  id                    String         @id @default(cuid())
  os_id                 String         @map("os_id")
  nome                  String         @db.VarChar(255)
  nome_original         String         @map("nome_original") @db.VarChar(255)
  tipo                  TipoAnexoOS
  mime_type             String         @map("mime_type") @db.VarChar(100)
  tamanho               BigInt
  descricao             String?        @db.Text
  caminho_s3            String         @map("caminho_s3") @db.VarChar(500)
  url_download          String?        @map("url_download") @db.VarChar(500)
  fase_execucao         String?        @map("fase_execucao") @db.VarChar(50)
  uploaded_at           DateTime       @default(now()) @map("uploaded_at")
  uploaded_by           String?        @map("uploaded_by") @db.VarChar(255)
  uploaded_by_id        String?        @map("uploaded_by_id") @db.Char(26)
  deletado_em           DateTime?      @map("deletado_em")

  ordem_servico         ordens_servico @relation(fields: [os_id], references: [id], onDelete: Cascade)

  @@map("anexos_os")
  @@index([os_id])
  @@index([tipo])
  @@index([uploaded_at])
  @@index([deletado_em])
}

// Registros de tempo detalhados
model registros_tempo_os {
  id                    String         @id @default(cuid())
  os_id                 String         @map("os_id")
  tecnico_id            String?        @map("tecnico_id") @db.Char(26)
  tecnico_nome          String         @map("tecnico_nome") @db.VarChar(255)
  data_hora_inicio      DateTime?      @map("data_hora_inicio") @db.Timestamp(0)
  data_hora_fim         DateTime?      @map("data_hora_fim") @db.Timestamp(0)
  tempo_total           Int?           @map("tempo_total") // em minutos
  atividade             String         @db.VarChar(500)
  observacoes           String?        @db.Text
  pausas                Json?          // Array de pausas
  created_at            DateTime       @default(now()) @map("created_at")
  updated_at            DateTime       @updatedAt @map("updated_at")

  ordem_servico         ordens_servico @relation(fields: [os_id], references: [id], onDelete: Cascade)

  @@map("registros_tempo_os")
  @@index([os_id])
  @@index([data_hora_inicio])
  @@index([tecnico_id])
}

// Schema para o módulo de ferramentas - Adaptado para sistema empresarial
model ferramentas {
  id                      String   @id @default(cuid()) @db.Char(26)
  organizacao_nome        String   @db.VarChar(255) // Nome da organização como texto
  
  // Dados básicos da ferramenta
  nome                    String   @db.VarChar(255)
  codigo_patrimonial      String   @db.VarChar(100)
  tipo                    String   @default("ferramenta") @db.VarChar(50) // fixo como "ferramenta"
  
  // Especificações técnicas
  fabricante              String   @db.VarChar(255)
  modelo                  String   @db.VarChar(255)
  numero_serie            String   @db.VarChar(255)
  
  // Calibração
  necessita_calibracao    Boolean  @default(false)
  proxima_data_calibracao DateTime? @db.Date
  
  // Localização e responsabilidade
  localizacao_atual       String   @db.VarChar(500)
  responsavel_id          String   @db.Char(26)
  planta_nome             String?  @db.VarChar(255) // Nome da planta como texto
  
  // Informações administrativas
  data_aquisicao          DateTime @db.Date
  valor_aquisicao         Decimal? @db.Decimal(10, 2) // Valor de compra para controle patrimonial
  status                  String   @default("disponivel") @db.VarChar(50) // disponivel, em_uso, manutencao, inativo
  
  // Documentação
  observacoes             String?  @db.Text
  foto_url                String?  @db.VarChar(500)
  manual_url              String?  @db.VarChar(500) // Link para manual/documentação
  
  // Auditoria
  criado_por              String   @db.Char(26)
  atualizado_por          String?  @db.Char(26)
  created_at              DateTime @default(now()) @db.Timestamp(0)
  updated_at              DateTime @updatedAt @db.Timestamp(0)
  deleted_at              DateTime? @db.Timestamp(0)
  deleted_by              String?  @db.Char(26)

  // Relacionamentos
  responsavel             usuarios     @relation("ferramentas_responsavel", fields: [responsavel_id], references: [id])
  criado_por_usuario      usuarios     @relation("ferramentas_criado_por", fields: [criado_por], references: [id])
  atualizado_por_usuario  usuarios?    @relation("ferramentas_atualizado_por", fields: [atualizado_por], references: [id])
  deleted_by_usuario      usuarios?    @relation("ferramentas_deleted_by", fields: [deleted_by], references: [id])
  
  // Relacionamentos dependentes
  historico_calibracoes   historico_calibracoes[]
  historico_manutencoes   historico_manutencoes[]
  
  @@unique([organizacao_nome, codigo_patrimonial], name: "ferramentas_org_codigo_unique")
  @@index([organizacao_nome], name: "idx_ferramentas_organizacao")
  @@index([responsavel_id], name: "idx_ferramentas_responsavel")
  @@index([planta_nome], name: "idx_ferramentas_planta")
  @@index([status], name: "idx_ferramentas_status")
  @@index([necessita_calibracao], name: "idx_ferramentas_calibracao")
  @@index([proxima_data_calibracao], name: "idx_ferramentas_data_calibracao")
  @@map("ferramentas")
}

// Histórico de calibrações
model historico_calibracoes {
  id                   String    @id @default(cuid()) @db.Char(26)
  ferramenta_id        String    @db.Char(26)
  data_calibracao      DateTime  @db.Date
  data_vencimento      DateTime  @db.Date
  responsavel          String    @db.VarChar(255) // Nome do laboratório/empresa responsável
  certificado_numero   String?   @db.VarChar(100)
  certificado_url      String?   @db.VarChar(500)
  observacoes          String?   @db.Text
  custo                Decimal?  @db.Decimal(10, 2)
  
  // Auditoria
  criado_por           String    @db.Char(26)
  created_at           DateTime  @default(now()) @db.Timestamp(0)
  updated_at           DateTime  @updatedAt @db.Timestamp(0)

  // Relacionamentos
  ferramenta           ferramentas @relation(fields: [ferramenta_id], references: [id], onDelete: Cascade)
  criado_por_usuario   usuarios    @relation("historico_calibracoes_criado_por", fields: [criado_por], references: [id])

  @@index([ferramenta_id], name: "idx_historico_calibracoes_ferramenta")
  @@index([data_vencimento], name: "idx_historico_calibracoes_vencimento")
  @@map("historico_calibracoes")
}

// Histórico de manutenções
model historico_manutencoes {
  id                String    @id @default(cuid()) @db.Char(26)
  ferramenta_id     String    @db.Char(26)
  tipo_manutencao   String    @db.VarChar(50) // preventiva, corretiva, calibracao
  data_inicio       DateTime  @db.Timestamp(0)
  data_fim          DateTime? @db.Timestamp(0)
  status_manutencao String    @default("em_andamento") @db.VarChar(50) // em_andamento, concluida, cancelada
  descricao         String    @db.Text
  solucao           String?   @db.Text
  custo             Decimal?  @db.Decimal(10, 2)
  fornecedor        String?   @db.VarChar(255)
  
  // Auditoria
  criado_por        String    @db.Char(26)
  atualizado_por    String?   @db.Char(26)
  created_at        DateTime  @default(now()) @db.Timestamp(0)
  updated_at        DateTime  @updatedAt @db.Timestamp(0)

  // Relacionamentos
  ferramenta        ferramentas @relation(fields: [ferramenta_id], references: [id], onDelete: Cascade)
  criado_por_usuario usuarios   @relation("historico_manutencoes_criado_por", fields: [criado_por], references: [id])
  atualizado_por_usuario usuarios? @relation("historico_manutencoes_atualizado_por", fields: [atualizado_por], references: [id])

  @@index([ferramenta_id], name: "idx_historico_manutencoes_ferramenta")
  @@index([tipo_manutencao], name: "idx_historico_manutencoes_tipo")
  @@index([status_manutencao], name: "idx_historico_manutencoes_status")
  @@map("historico_manutencoes")
}